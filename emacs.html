<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title> Emacs 配置 - Ward of Bardust </title>
<meta name="author" content="Bardust">
<link rel="shortcut icon" href="/static/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="/static/Spectral/style.css">
<link rel="stylesheet" href="/static/LXGWWenKai/style.css">
<link rel="stylesheet" href="/static/style.css">
<link rel="stylesheet" href="/static/FantasqueSansMono/style.css"/>
<link rel="stylesheet" href="/static/prism/style.css">
</head>
<body>
<div id="preamble" class="status">
<div class="header">
<div class="title">
<a href="/">Ward of Bardust</a>
</div>
<div class="navigation">
<a class="item" href="/archive.html">Archives</a>
<a class="item" href="/taxonomy.html">Taxonomy</a>
<a class="item" href="/about.html">About</a></div>
</div>
</div>
<div id="content" class="content">
<div class="post">
<h1 class="title">Emacs 配置</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#Todo List <code>[0/6]</code>">Todo List <code>[0/6]</code></a>
<ul>
<li><a href="#window configuration save"><span class="todo TODO">TODO</span> window configuration save</a></li>
<li><a href="#Number prefix in select mode"><span class="todo TODO">TODO</span> Number prefix in select mode</a></li>
<li><a href="#Transfer config to pure elisp"><span class="todo TODO">TODO</span> Transfer config to pure elisp</a></li>
<li><a href="#typst-ts-mode"><span class="todo TODO">TODO</span> typst-ts-mode</a></li>
<li><a href="#Find out the warning when Emacs starts up"><span class="todo TODO">TODO</span> Find out the warning when Emacs starts up</a></li>
<li><a href="#Transient to replace hypra"><span class="todo TODO">TODO</span> Transient to replace hypra</a></li>
</ul>
</li>
<li><a href="#前言">前言</a></li>
<li><a href="#前配置 early-init">前配置 early-init</a>
<ul>
<li><a href="#定义基本变量">定义基本变量</a></li>
<li><a href="#启动加速">启动加速</a></li>
<li><a href="#编码设置">编码设置</a></li>
<li><a href="#GUI 设置">GUI 设置</a></li>
<li><a href="#杂七杂八的设置">杂七杂八的设置</a></li>
<li><a href="#结束 early-init">结束 early-init</a></li>
</ul>
</li>
<li><a href="#SetupEl">SetupEl</a>
<ul>
<li><a href="#简介">简介</a></li>
<li><a href="#安装">安装</a></li>
<li><a href="#子系统与上下文">子系统与上下文</a></li>
<li><a href="#绑定">绑定</a></li>
<li><a href="#包调用">包调用</a></li>
<li><a href="#赋值">赋值</a></li>
<li><a href="#钩子">钩子</a></li>
<li><a href="#条件">条件</a></li>
<li><a href="#自定义关键字">自定义关键字</a>
<ul>
<li><a href="#:doc">:doc</a></li>
<li><a href="#:package">:package</a></li>
<li><a href="#:load-path">:load-path</a></li>
<li><a href="#:after">:after</a></li>
<li><a href="#:diminish">:diminish</a></li>
<li><a href="#:advice">:advice</a></li>
<li><a href="#:face">:face</a></li>
<li><a href="#:global">:global</a></li>
<li><a href="#:disabled">:disabled</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#基础设置">基础设置</a>
<ul>
<li><a href="#基础库">基础库</a></li>
<li><a href="#基本设置">基本设置</a></li>
<li><a href="#模态编辑">模态编辑</a></li>
<li><a href="#Minibuffer">Minibuffer</a></li>
</ul>
</li>
<li><a href="#外观设置">外观设置</a>
<ul>
<li><a href="#字体设置">字体设置</a></li>
<li><a href="#主题设置">主题设置</a></li>
<li><a href="#状态栏">状态栏</a></li>
</ul>
</li>
<li><a href="#编辑设置">编辑设置</a>
<ul>
<li><a href="#基本编辑操作">基本编辑操作</a></li>
<li><a href="#Select mode">Select mode</a></li>
<li><a href="#窗口设置">窗口设置</a>
<ul>
<li><a href="#窗口分割">窗口分割</a></li>
<li><a href="#窗口间移动">窗口间移动</a></li>
</ul>
</li>
<li><a href="#括号增强">括号增强</a>
<ul>
<li><a href="#高亮括号">高亮括号</a></li>
<li><a href="#Smart Parens">Smart Parens</a></li>
</ul>
</li>
<li><a href="#补全增强">补全增强</a>
<ul>
<li><a href="#补全前端">补全前端</a></li>
<li><a href="#补全后端">补全后端</a></li>
<li><a href="#补全模版">补全模版</a></li>
</ul>
</li>
<li><a href="#Minibuffer 增强">Minibuffer 增强</a></li>
<li><a href="#Isearch 增强">Isearch 增强</a></li>
</ul>
</li>
<li><a href="#编程">编程</a>
<ul>
<li><a href="#显示">显示</a>
<ul>
<li><a href="#行号">行号</a></li>
<li><a href="#高亮当前行">高亮当前行</a></li>
<li><a href="#彩色括号">彩色括号</a></li>
<li><a href="#eldoc">eldoc</a></li>
<li><a href="#缩进提示">缩进提示</a></li>
</ul>
</li>
<li><a href="#移动到缩进行首">移动到缩进行首</a></li>
<li><a href="#代码折叠">代码折叠</a></li>
<li><a href="#Tree-sitter">Tree-sitter</a></li>
<li><a href="#LSP">LSP</a></li>
<li><a href="#Python">Python</a></li>
<li><a href="#YAML">YAML</a></li>
<li><a href="#Emacs Lisp">Emacs Lisp</a>
<ul>
<li><a href="#elisp-def">elisp-def</a></li>
</ul>
</li>
<li><a href="#Yuck">Yuck</a></li>
<li><a href="#Sxhkd">Sxhkd</a></li>
<li><a href="#Jinja2">Jinja2</a></li>
<li><a href="#Markdown">Markdown</a></li>
</ul>
</li>
<li><a href="#Org mode">Org mode</a>
<ul>
<li><a href="#org mode 设置">org mode 设置</a></li>
<li><a href="#快速改变 heading">快速改变 heading</a></li>
<li><a href="#快速插入">快速插入</a></li>
<li><a href="#Org Agenda">Org Agenda</a></li>
<li><a href="#org mode 美化">org mode 美化</a>
<ul>
<li><a href="#Org Modern">Org Modern</a></li>
<li><a href="#排版">排版</a></li>
</ul>
</li>
<li><a href="#Latex 相关">Latex 相关</a></li>
<li><a href="#快速查询">快速查询</a></li>
<li><a href="#Org Mobile">Org Mobile</a></li>
</ul>
</li>
<li><a href="#工具">工具</a>
<ul>
<li><a href="#输入法">输入法</a></li>
<li><a href="#文件管理">文件管理</a></li>
<li><a href="#中文分词">中文分词</a></li>
<li><a href="#大纲展示">大纲展示</a></li>
<li><a href="#摘抄库">摘抄库</a></li>
<li><a href="#音乐播放器">音乐播放器</a></li>
<li><a href="#邮件与订阅">邮件与订阅</a></li>
<li><a href="#日志">日志</a></li>
<li><a href="#笔记管理">笔记管理</a></li>
<li><a href="#书籍管理">书籍管理</a></li>
<li><a href="#文档阅读">文档阅读</a>
<ul>
<li><a href="#PDF">PDF</a></li>
<li><a href="#EPUB">EPUB</a></li>
<li><a href="#DJUV">DJUV</a></li>
</ul>
</li>
<li><a href="#Typst">Typst</a>
<ul>
<li><a href="#安装 Treesit For Typst">安装 Treesit For Typst</a></li>
<li><a href="#配置">配置</a></li>
<li><a href="#trouble">trouble</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#配置结束">配置结束</a></li>
</ul>
</div>
</div>

<div id="outline-container-Todo List <code>[0/6]</code>" class="outline-2">
<h2 id="Todo List <code>[0/6]</code>"><a href="#Todo List <code>[0/6]</code>">Todo List <code>[0/6]</code></a></h2>
<div class="outline-text-2" id="text-orgba1cdff">
</div>
<div id="outline-container-window configuration save" class="outline-3">
<h3 id="window configuration save"><a href="#window configuration save"><span class="todo TODO">TODO</span> window configuration save</a></h3>
<div class="outline-text-3" id="text-orgc89ae44">
<p>
auto flow
</p>
</div>
</div>
<div id="outline-container-Number prefix in select mode" class="outline-3">
<h3 id="Number prefix in select mode"><a href="#Number prefix in select mode"><span class="todo TODO">TODO</span> Number prefix in select mode</a></h3>
</div>
<div id="outline-container-Transfer config to pure elisp" class="outline-3">
<h3 id="Transfer config to pure elisp"><a href="#Transfer config to pure elisp"><span class="todo TODO">TODO</span> Transfer config to pure elisp</a></h3>
</div>
<div id="outline-container-typst-ts-mode" class="outline-3">
<h3 id="typst-ts-mode"><a href="#typst-ts-mode"><span class="todo TODO">TODO</span> typst-ts-mode</a></h3>
</div>
<div id="outline-container-Find out the warning when Emacs starts up" class="outline-3">
<h3 id="Find out the warning when Emacs starts up"><a href="#Find out the warning when Emacs starts up"><span class="todo TODO">TODO</span> Find out the warning when Emacs starts up</a></h3>
</div>
<div id="outline-container-Transient to replace hypra" class="outline-3">
<h3 id="Transient to replace hypra"><a href="#Transient to replace hypra"><span class="todo TODO">TODO</span> Transient to replace hypra</a></h3>
</div>
</div>
<div id="outline-container-前言" class="outline-2">
<h2 id="前言"><a href="#前言">前言</a></h2>
<div class="outline-text-2" id="text-org0aedc6e">
<p>
Emacs 配置分享，下载路径在 GitHub 上：<a target="_blank" href="https://github.com/fingerknight/.emacs.d">https://github.com/fingerknight/.emacs.d</a>.
</p>
</div>
</div>

<div id="outline-container-前配置 early-init" class="outline-2">
<h2 id="前配置 early-init"><a href="#前配置 early-init">前配置 early-init</a></h2>
<div class="outline-text-2" id="text-orgcec06e7">
</div>

<div id="outline-container-定义基本变量" class="outline-3">
<h3 id="定义基本变量"><a href="#定义基本变量">定义基本变量</a></h3>
<div class="outline-text-3" id="text-org2925fa6">
<div class="org-src-container">
<pre>
<code class="language-elisp">;;; -*- lexical-binding: t; -*-

(defconst user-home-directory
  (pcase system-type
    ('windows-nt "%userprofile%/")
    (otherwise "~/"))
  "User Home directory")</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-启动加速" class="outline-3">
<h3 id="启动加速"><a href="#启动加速">启动加速</a></h3>
<div class="outline-text-3" id="text-org7731c0a">
<p>
调整 GC，关闭一些不必要的功能 <sup class="fsup"><a id="fnr.1.1" class="footref" href="#fn.1" role="doc-backlink">[1]</a></sup> <sup>, </sup><sup class="fsup"><a id="fnr.2.1" class="footref" href="#fn.2" role="doc-backlink">[2]</a></sup>。
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">;;; Basic settings
;;

;; Speed up starting
(setq gc-cons-percentage 1.0
      gc-cons-threshold most-positive-fixnum
      ;; package-enable-at-startup nil
      inhibit-compacting-font-caches t)

(let ((old-file-name-handler-alist file-name-handler-alist))
  ;; https://emacs.nasy.moe/#%E5%88%9D--early-init-
  (setq-default file-name-handler-alist nil)
  (defun restore--default ()
    "Restore gc setting to default."
    (setq file-name-handler-alist
          (delete-dups (append file-name-handler-alist
                               old-file-name-handler-alist))
          inhibit-trace nil))
  (add-hook 'emacs-startup-hook #'restore--default))

(setq-default bidi-display-reordering 'left-to-right)
(setq-default bidi-paragraph-direction 'left-to-right)
(setq bidi-inhibit-bpa t)</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-编码设置" class="outline-3">
<h3 id="编码设置"><a href="#编码设置">编码设置</a></h3>
<div class="outline-text-3" id="text-org088f851">
<p>
设置 UTF-8 编码 <sup class="fsup"><a id="fnr.3.1" class="footref" href="#fn.3" role="doc-backlink">[3]</a></sup>
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">;; Coding System
(setq locale-coding-system 'utf-8)
(set-language-environment "UTF-8")
(set-default-coding-systems 'utf-8)
(set-buffer-file-coding-system 'utf-8)
(set-clipboard-coding-system 'utf-8)
(set-file-name-coding-system 'utf-8)
(set-keyboard-coding-system 'utf-8)
(set-next-selection-coding-system 'utf-8)
(set-selection-coding-system 'utf-8)
(set-terminal-coding-system 'utf-8)
(prefer-coding-system 'utf-8)</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-GUI 设置" class="outline-3">
<h3 id="GUI 设置"><a href="#GUI 设置">GUI 设置</a></h3>
<div class="outline-text-3" id="text-orgfd4878c">
<p>
窗口最大化，关闭各种栏栏框框。
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">;; GUI
(add-to-list 'default-frame-alist '(fullscreen . maximized))
(add-to-list 'default-frame-alist '(vertical-scroll-bars . nil))
(add-to-list 'default-frame-alist '(horizontal-scroll-bars . nil))
(add-to-list 'default-frame-alist '(tool-bar-lines . 0))
(add-to-list 'default-frame-alist '(menu-bar-lines . 0))
;; (add-to-list 'default-frame-alist '(alpha-background . 90))</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-杂七杂八的设置" class="outline-3">
<h3 id="杂七杂八的设置"><a href="#杂七杂八的设置">杂七杂八的设置</a></h3>
<div class="outline-text-3" id="text-org78d4670">
<div class="org-src-container">
<pre>
<code class="language-elisp">;; Misc
(setq
 ;; url-proxy-services '(("http" . "127.0.0.1:7890")
                           ;; ("https" . "127.0.0.1:7890"))
      ring-bell-function 'ignore
      make-backup-files nil
      mouse-wheel-scroll-amount '(1 ((shift) . 1) ((control) . nil))
      mouse-wheel-progressive-speed nil
      next-line-add-newlines t
      confirm-kill-processes nil
      enable-recursive-minibuffers t
      frame-inhibit-implied-resize t
      ad-redefinition-action 'accept
      inhibit-startup-message t
      inhibit-startup-echo-area-message t
      initial-major-mode 'fundamental-mode
      initial-scratch-message nil
      initial-scratch-message nil
      echo-keystrokes 0.25
      custom-file (expand-file-name "custom.el" user-emacs-directory))</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-结束 early-init" class="outline-3">
<h3 id="结束 early-init"><a href="#结束 early-init">结束 early-init</a></h3>
<div class="outline-text-3" id="text-org5292446">
<div class="org-src-container">
<pre>
<code class="language-elisp">(provide 'early-init)</code>
</pre>

</div>
</div>
</div>
</div>

<div id="outline-container-SetupEl" class="outline-2">
<h2 id="SetupEl"><a href="#SetupEl">SetupEl</a></h2>
<div class="outline-text-2" id="text-orgdaad7c5">
</div>
<div id="outline-container-简介" class="outline-3">
<h3 id="简介"><a href="#简介">简介</a></h3>
<div class="outline-text-3" id="text-org2bfad0c">
<p>
<a target="_blank" href="https://git.sr.ht/~pkal/setup">setup.el</a> 是一套宏，可以用于做包和模块的管理。与各种包管理器类似，在 <code>(setup feature ...)</code> 中通过各种关键字来实现各种各样的功能。它提供了一套基础的关键字，很基础。但是自定义关键字非常简单。
</p>

<p>
setup.el 内置关键字有：
</p>
<ul class="org-ul">
<li>上下文 <code>:with-feature</code>, <code>:with-mode</code>, <code>:with-map</code>, <code>:with-hook</code>, <code>:with-function</code></li>
<li>绑定 <code>:global</code> <code>:bind</code>, <code>:unbind</code>, <code>:rebind</code></li>
<li>包调用 <code>:package</code>, <code>:requrie</code>, <code>:as-load</code></li>
<li>赋值 <code>:option</code>, <code>:local-set</code></li>
<li>钩子 <code>:hook</code>, <code>:hook-into</code>, <code>local-hook</code></li>
<li>条件 <code>:only-if</code>, <code>:file-match</code>, <code>:when-loaded</code>, <code>:and</code>, <code>:if-package</code>, <code>:if-feature</code></li>
</ul>
<p>
看一个简单的例子：
</p>
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup rainbow-delimiters
  (:package rainbow-delimiters)
  (:require rainbow-delimiters-mode)
  (:hook-into prog-mode)
  ;; more body
  )</code>
</pre>

</div>

<p>
定义了一个 <code>rainbow-delimiters</code> 的子系统； <code>:package</code> 是说如果给定的包不存在，则会通过 <code>packge-install</code> 去安装它； <code>:require</code> 就是 require 这个包； <code>:hook-into</code> 就是把 <code>rainbow-delimiters-mode</code> 添加到 <code>prog-mode-hook</code> 中。之后还可以写上各种各样的函数。
</p>

<p>
<a target="_blank" href="https://www.emacswiki.org/emacs/SetupEl">Emacs Wiki</a> 上给出了许多详细完好的例子。
</p>
</div>
</div>

<div id="outline-container-安装" class="outline-3">
<h3 id="安装"><a href="#安装">安装</a></h3>
<div class="outline-text-3" id="text-org914c139">
<div class="org-src-container">
<pre>
<code class="language-elisp">;;; -*- lexical-binding: t; -*-

;;; Packages
(require 'package)
(require 'package-vc)

(add-to-list 'package-archives '("melpa" . "https://melpa.org/packages/"))

;;; SetupEl
(unless (package-installed-p 'setup)
  (package-install 'setup))
(require 'setup)</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-子系统与上下文" class="outline-3">
<h3 id="子系统与上下文"><a href="#子系统与上下文">子系统与上下文</a></h3>
<div class="outline-text-3" id="text-org6c476d4">
<p>
<code>(setup feature)</code> 表明配置一个名为 <code>feature</code> 的子系统。这个名字可以任意，可以是已存在的包名。如果是后者，后续可以方便的传入一些参数。
</p>

<p>
setup 子系统的过程中，会保持几个变量： <code>feature</code>, <code>mode</code>, <code>map</code>, <code>hook</code>, <code>function</code>, 这几个变量都应与子系统相关联，使得子系统配置过程中变量的调用更加可靠。
</p>

<p>
<code>feature</code> 就是一个子系统，在逻辑上是一堆变量和函数的集合，不太合适也可以把它理解为 package 。feature 会延伸出其他变量的定义。
</p>

<p>
比如给定 feature 为 <code>rainbow-delimiters</code>, 在不做改动的情况下：
</p>
<ul class="org-ul">
<li>mode 是 feature 的延拓，为 <code>rainbow-delimiters-mode</code></li>
<li>function 同 mode</li>
<li>hook 是 mode 的延拓，为 <code>rainbow-delimiters-mode-hook</code></li>
<li>map 是 mode 的延拓，为 <code>rainbow-delimiters-mode-map</code></li>
</ul>

<p>
这些延拓都是为了后续使用的方便。如前面例子，要加一个 hook, 本来的写法应该是
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">(add-hook 'prog-mode-hook #'rainbow-delimiters-mode)</code>
</pre>

</div>

<p>
在 setup 下是
</p>
<div class="org-src-container">
<pre>
<code class="language-elisp">(:hook-into prog-mode)</code>
</pre>

</div>

<p>
<code>prog-mode</code> 会延拓成 <code>prog-mode-hook</code>; <code>:hook-into</code> 会把当前系统的 function 也就是 <code>rainbow-delimiters-mode</code> （默认情况下同 mode）加入到钩子中。如此做一番抽象，配置就显得明晰而简练。
</p>

<p>
那几个 with 相关的关键字是为了改变当前系统下的默认延拓。比较典型的例子，minad 大神开发的插件如 vertico, corfu. <code>(setup cofu)</code> 系统下的 map 默认为 <code>corfu-mode-map</code>, 因为 feature 延拓为 mode, 再延拓为 map. 但是实际上的 map 是 <code>corfu-map</code>, 这时就需要用 with 来改变上下文：
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup corfu
  (:with-map corfu-map
    ;; 系统d  map 切换到 `corfu-map'

    )
  )</code>
</pre>

</div>

<p>
注意， <code>:with-feature</code> 和 <code>:with-mode</code> 依然会改变 function, map 和 hook, 因为它们是前二者的延拓. 只有 with 后三者不会影响其他的变量。
</p>

<p>
至此，你应该大致理解了子系统内部的几个变量的关系，以及窥探了后续绑定和使用过程的抽象所带来的便利。接下来便是对各个关键词进行介绍。
</p>
</div>
</div>

<div id="outline-container-绑定" class="outline-3">
<h3 id="绑定"><a href="#绑定">绑定</a></h3>
<div class="outline-text-3" id="text-orge53a16f">
<p>
<code>:global</code> 用于全局绑定，无关 feature. 如 <code>(:global "RET" newline-and-indent)</code>
</p>

<p>
<code>:bind</code> 绑定到当前系统的 map. 如 <code>(:with-feature org (:bind "C-c s" org-schedule))</code>  就会在 <code>org-mode-map</code> 下绑定按键。它是 <code>after-loaded</code> 的（详见<a href="#自定义关键字">自定义关键字</a>），也就是它会等当前系统加载之后才绑定（防止对应的变量还没有定义），所以展开之后其实是：
</p>
<div class="org-src-container">
<pre>
<code class="language-elisp">(with-eval-after-load 'org
  (define-key 'org-mode-map "C-c s" #'org-schedule))</code>
</pre>

</div>

<p>
此外，它还是 <code>repeatable</code> 的，也就是可以连续绑定，如：
</p>
<div class="org-src-container">
<pre>
<code class="language-elisp">(:bind "C-c s" org-schedule
       "C-s d" org-deadlin)</code>
</pre>

</div>

<p>
,所有五个绑定关键字都是 <code>repeatable</code>, 也就是可以连续输入。
</p>

<p>
<code>:unbind</code> 清空按键绑定， <code>:rebind</code> 重新绑定按键。
</p>

<p>
除了 <code>:global</code> 的绑定都是 <code>after-loaded</code> 的，只要 feature 设置正确了，就不会出现 map 还没定义的情况。
</p>
</div>
</div>

<div id="outline-container-包调用" class="outline-3">
<h3 id="包调用"><a href="#包调用">包调用</a></h3>
<div class="outline-text-3" id="text-org34b6959">
<p>
前面提到过 <code>:package</code> 是用来安装包的，它指定了 shorthand （详见<a href="#自定义关键字">自定义关键字</a>），所以可以用来做 feature. 如下面这个系统的 feature 是 <code>simple</code>.
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package simple)
  )</code>
</pre>

</div>

<p>
<code>:package</code> 是 repeatable 所以可以一次安装多个包。但是只有第一个包会作为系统的 feature. <code>package.el</code> 不能安装非官方如 GitHub 上的保，后续会重写这个关键字。
</p>

<p>
<code>:require</code> 调用包，repeatable, 且有 shorthand, 所以同样可以作为系统的 feature.
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:require cl-lib)
  )</code>
</pre>

</div>

<p>
<code>:also-load</code> 用来 require 后续包。它是 after-loaded, 因此只要在 feature 加载之后才会调用，强调调用顺序。
</p>
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup cofu
  (:also-load corfu-popinfo)
  (:audoload corfu-mode))</code>
</pre>

</div>
<p>
只要在使用了 <code>corfu-mode</code> 这个 autoload 后，corfu 这个 feature 加载，然后才会 requrie <code>corfu-popinfo</code>.
</p>
</div>
</div>

<div id="outline-container-赋值" class="outline-3">
<h3 id="赋值"><a href="#赋值">赋值</a></h3>
<div class="outline-text-3" id="text-orgda3b8a3">
<p>
<code>:option</code> 是一个集大成的赋值方法，它是 repeatable, 因此使用方法和 <code>setq</code> 类似。如
</p>
<div class="org-src-container">
<pre>
<code class="language-elisp">(:option savehist-autosave-interval 300
         history-length 1000
         kill-ring-max 300
         history-delete-duplicates t)</code>
</pre>

</div>

<p>
说它集大成的之一是它集成了 <code>set-default</code> 和 <code>custom</code>, 也就是它可以用来设置 custom 的变量，且无视赋值位置，这一来便无需知晓某个变量的赋值应该是在 require 之前还是之后。
</p>

<p>
其二是因为它还能对列表进行赋值。以环境变量为例，设置都是 <code>(add-to-list 'load-path "path")</code>. 通过 <code>:option</code> 设置为 <code>(:option (prepend load-path) "path")</code>.
</p>

<p>
<code>prepend</code> 意思是把输入插入到列表前端，如果以存在则跳过。对应的是 <code>append</code>, 把输入放置到列表末尾。还有一个 <code>remove</code>, 就是把输入从列表中移除。
</p>

<p>
输入可以是一个列表，然后声名方式改变：
</p>
<ul class="org-ul">
<li><code>prepend*</code> 把输入列表中的每个元素按顺序插入到列表变量（也就是上面例子中的 <code>load-path</code> ）的开头，如果以存在则跳过</li>
<li><code>append*</code> 把输入列表中的每个元素按顺序接入到列表变量的末尾，如果以存在则跳过</li>
<li><code>remove*</code> 移除列表变量中所有在输入列表中的元素</li>
</ul>

<p>
还有一个局部赋值的关键字 <code>:local-set</code>, 使用方法与 <code>:option</code> 相同，只是它用的是 <code>setq-local</code> 来在当前 buffer 中进行局部赋值。
</p>
</div>
</div>

<div id="outline-container-钩子" class="outline-3">
<h3 id="钩子"><a href="#钩子">钩子</a></h3>
<div class="outline-text-3" id="text-org1c26287">
<p>
<code>:hook</code>, repeatable, 输入的是函数，把这些函数都钩到当前系统的 hook 中。如：
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup prog-mode
  (:hook hl-mode))</code>
</pre>

</div>

<p>
用的更多的是 <code>:hook-into</code>, 同样 repeatable, 输入的是钩子，把当前系统的函数添加到这些钩子中。如把 <code>elisp-def-mode</code> 添加到钩子 <code>emacs-lisp-mode-hook</code> 和 <code>ielm-mode-hook</code> 中：
</p>
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup elisp-def
  (:require elisp-def)
  (:hook-into emacs-lisp-mode ielm-mode))</code>
</pre>

</div>

<p>
<code>local-hook</code> 同 <code>:hook</code>, 只是局部添加钩子。
</p>

<p>
以上的钩子操作都不是 after-loaded, 也就是需要钩子触发前 require 或 autoload 对应的函数。
</p>
</div>
</div>

<div id="outline-container-条件" class="outline-3">
<h3 id="条件"><a href="#条件">条件</a></h3>
<div class="outline-text-3" id="text-orgf98a133">
<p>
<code>:only-if</code> 判断条件，条件为假时整个 setup 退出。
</p>

<p>
<code>:file-match</code> 这个就是常用的 mode 匹配文件名的配置。比如要把 yaml-mode 匹配到 <code>.yml</code> 或 <code>.yaml</code> 为后缀的文件，则配置：
</p>
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:require yaml-mode)
  (:file-match "\\.\\(yml\\|yaml\\)\\'"))</code>
</pre>

</div>

<p>
<code>:when-loaded</code> 当系统 feature 加载之后执行的操作， <code>(:when-loaded ...)</code> 等价于 <code>(with-eval-after-load 'feature ...)</code>. 当时文档中不建议使用这个关键字，因为它潜在的使用的系统 feature, 应该明确指定等待哪个 feature 加载。后续使用改良后的 <code>:after</code> 。
</p>

<p>
<code>:if-package</code> 如果包未安装则退出， <code>:if-feature</code> 如果不是 feature (feature 未加载则退出)。简单理解，前者是看包有没有安装到本地，后者是看包有没有加载到 Emacs. 
</p>

<p>
<code>:and</code> 多个判断条件，使用同 <code>cond</code>, 当有一个为假时，setup 退出。最后一个判断 <b>*条件</b>用来修改 feature. 我自己没用过这个关键字，具体行为不太清楚。
</p>
</div>
</div>

<div id="outline-container-自定义关键字" class="outline-3">
<h3 id="自定义关键字"><a href="#自定义关键字">自定义关键字</a></h3>
<div class="outline-text-3" id="text-org7d76a7b">
<p>
<a target="_blank" href="https://www.emacswiki.org/emacs/SetupEl">Emacs Wiki</a> 上给出了许多有用的自定义关键字，我使用了其中一些。自定义关键字的框架是：
</p>
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup-define :keywords
  macro
  args...)</code>
</pre>

</div>

<p>
其中，macro 返回一段宏，args 指定关键字的属性。
</p>

<p>
setup 的执行过程就是把 body 当作宏来执行，因此关键字函数返回的便是一段宏，或者可执行的代码。
</p>
</div>

<div id="outline-container-:doc" class="outline-4">
<h4 id=":doc"><a href="#:doc">:doc</a></h4>
<div class="outline-text-4" id="text-orga00e6ff">
<p>
先定义一个简单的 <code>:doc</code>, 用来记录当前系统的文档信息 <sup class="fsup"><a id="fnr.1.2" class="footref" href="#fn.1" role="doc-backlink">[1]</a></sup>。
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup-define :doc
  (lambda (_)
    nil)
  :documentation "Document for the setup package."
  :repeatable t)</code>
</pre>

</div>

<p>
macro 返回的是 nil, 也就是这个关键词并不会真正参与到 setup 中，它的作用只是在代码中作为 document 的存在，让人看见。这里有两个参数： <code>:documentation</code> 当前关键字的文档， <code>:repeatable</code> 前面提到过的，是否可重复，如以下：
</p>
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup dash
  (:doc "A modern list API for Emacs."
        "https://github.com/magnars/dash.el")
  (:require dash))</code>
</pre>

</div>

<p>
看起来输入的是两个参数，但因为是 repeatable, 实际上是两个参数返回了两个宏，并不是两个参数同时传到一个宏。
</p>
</div>
</div>

<div id="outline-container-:package" class="outline-4">
<h4 id=":package"><a href="#:package">:package</a></h4>
<div class="outline-text-4" id="text-orgcbb49e6">
<p>
重写 <code>:package</code> ，将 <code>package-vc</code> 整合其中，如此便可以安装 GitHub 上的非官方包。
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">(defvar setup--package-refreshed-p t)

(defun setup--package-install (pkg)
  (let (pkg-name url)
    (if (consp pkg)
      (setq pkg-name (car pkg)
        url (cadr pkg))
      (setq pkg-name pkg))

    (unless (package-installed-p pkg-name)
      (unless setup--package-refreshed-p
        (package-refresh-contents)
        (setq setup--package-refreshed-p t))
      (message "Installing package: %s" pkg-name)
      (if url
          (package-vc-install url nil nil pkg-name)
        (package-install pkg-name)))))

(setup-define :package
          (lambda (pkg)
        `(setup--package-install ',pkg))
          :documentation "Install package by Git if it hasn't been installed yet.
CON is a list, with package-name as first element,
and Git repository URL as second element.
The first PACKAGE can be used to deduce the feature context."
          :repeatable t
          :shorthand 
          (lambda (heads)
        (let ((pkg (cadr heads)))
          (if (consp pkg)
              (car pkg)
            pkg))))</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-:load-path" class="outline-4">
<h4 id=":load-path"><a href="#:load-path">:load-path</a></h4>
<div class="outline-text-4" id="text-orgfce8d56">
<p>
定义环境变量关键字，它可以传入一个 sexp, 把它的返回值加入环境变量，也可以是绝对路径，还可以是相对路径，相对于当前 feature 所在的路径（就是 <code>guess-path</code> ），最后返回一个 <code>add-to-list</code> 的宏。
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup-define :load-path
  (lambda (path)
    (when (and (stringp path)
               (not (file-name-absolute-p path)))
      (let ((guess-path (directory-files package-user-dir t
                                         (format "%s" (setup-get 'feature)))))
        (when (and guess-path
                   (file-exists-p (car guess-path)))
          (setq path (expand-file-name path
                                       (car guess-path))))))
    `(add-to-list 'load-path ,path t))
  :documentation "Update load-path."
  :repeatable t)</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-:after" class="outline-4">
<h4 id=":after"><a href="#:after">:after</a></h4>
<div class="outline-text-4" id="text-org7110b2b">
<p>
改良版的 <code>:when-loaded</code>, 它明确指定一个 feature 来使用 <code>with-eval-after-load</code>.
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup-define :after
  (lambda (features &amp;rest body)
    (let (bodies)
      (dolist (feature (if (listp features) features (list features)))
        (push `(with-eval-after-load ',feature
                 (:with-feature ,feature
                   ,@body))
              bodies))
      (macroexp-progn (nreverse bodies))))
  :documentation "Eval BODY after FEATURES.
If FEATURES is a list, apply BODY to all elements inside."
  :indent 1)</code>
</pre>

</div>

<p>
这里有一个新的参数 <code>:indent</code> ，它用来控制 emacs 显示这段关键词相关代码时的缩进。类型是整数，表示第几个参数换行时缩进。以内置的 <code>:bind-into</code> 为例（以弃用）。如果不设置（即为 0），那么它就会是这样的缩进：
</p>
<div class="org-src-container">
<pre>
<code class="language-elisp">(:bind-into map
            "C-c" cmd)</code>
</pre>

</div>

<p>
丑的过于离谱。设置 <code>:indent 1</code> 之后就会是：
</p>
<div class="org-src-container">
<pre>
<code class="language-elisp">(:bind-into map
  "C-c" cmd)</code>
</pre>

</div>

<p>
这样看上去就舒服多了。这样应当可以理解它的作用了。
</p>
</div>
</div>

<div id="outline-container-:diminish" class="outline-4">
<h4 id=":diminish"><a href="#:diminish">:diminish</a></h4>
<div class="outline-text-4" id="text-orga3cd5a4">
<p>
使用 <a target="_blank" href="https://github.com/myrjola/diminish.el">diminish.el</a> 包，移除当前 minor-mode 在 mode-line 上的显示 <sup class="fsup"><a id="fnr.4.1" class="footref" href="#fn.4" role="doc-backlink">[4]</a></sup>。
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup-define :diminish
  (lambda (&amp;optional opt)
    `(diminish ',(setup-get 'mode) ,opt))
  :documentation "Hide the mode-line lighter of the current mode."
  :after-loaded t)</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-:advice" class="outline-4">
<h4 id=":advice"><a href="#:advice">:advice</a></h4>
<div class="outline-text-4" id="text-org6d8e6b1">
<p>
添加 advice, 采用的是类似 <code>define-advice</code> 的形式 <sup class="fsup"><a id="fnr.4.2" class="footref" href="#fn.4" role="doc-backlink">[4]</a></sup>。
</p>
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup-define :advice
  (lambda (symbol where arglist &amp;rest body)
    (let ((name (gensym "setup-advice-")))
      `(progn
         (defun ,name ,arglist ,@body)
         (advice-add ',symbol ,where #',name))))
  :documentation "Add a piece of advice on a function.
See `advice-add' for more details."
  :after-loaded t
  :debug '(sexp sexp function-form)
  :indent 3)</code>
</pre>

</div>

<p>
使用方法：
</p>
<div class="org-src-container">
<pre>
<code class="language-elisp">(:advice old-func :before (a b c)
  body)

;; 等价于
(define-advice old-func (:before (a b c))
  body)

;; 等价于
(advice-add old-func
  :before
  (lambda ()
    body))</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-:face" class="outline-4">
<h4 id=":face"><a href="#:face">:face</a></h4>
<div class="outline-text-4" id="text-org0395741">
<p>
这个关键字和 <code>:advice</code> 一样有点无聊，但是还是把它包装起来了。通过调用 <code>set-face-attribute</code> 方法来设置字体样式。
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup-define :face
  (lambda (face &amp;rest args)
    (cl-assert (eventp (length args)))
    (let ((ret '(progn)))
      (dotimes (i (/ (length args) 2))
        (push `(set-face-attribute ',face nil ,(nth (* 2 i) args) ,(nth (1+ (* 2 i)) args))
              ret))
      (reverse ret)))
  :documentation "Set FACE's attributes."
  :after-loaded t
  :indent 1)</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-:global" class="outline-4">
<h4 id=":global"><a href="#:global">:global</a></h4>
<div class="outline-text-4" id="text-org54196c4">
<p>
原本 <code>:global</code> 就是单纯用来绑定全局按键的，现在加一个 hook, 把对应的按键也绑到 minibuffer 上
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup-define :global
  (lambda (key command)
    `(progn
       (global-set-key ,key ,command)
       (define-key minibuffer-mode-map ,key ,command)))
  :documentation "Globally bind KEY to COMMAND, also in minibuffer."
  :debug '(form sexp)
  :ensure '(kbd func)
  :repeatable t)</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-:disabled" class="outline-4">
<h4 id=":disabled"><a href="#:disabled">:disabled</a></h4>
<div class="outline-text-4" id="text-orgb51fb89">
<p>
停止后续setup, 用来调试或者弃用某个 feature.
</p>
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup-define :disabled
  #'setup-quit
  :documentation "Unconditionally abort the evaluation of the current body.")</code>
</pre>

</div>

<p>
无参数，直接在最开始 <code>(:disabled)</code> 即可。
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-基础设置" class="outline-2">
<h2 id="基础设置"><a href="#基础设置">基础设置</a></h2>
<div class="outline-text-2" id="text-org34c4984">
</div>
<div id="outline-container-基础库" class="outline-3">
<h3 id="基础库"><a href="#基础库">基础库</a></h3>
<div class="outline-text-3" id="text-orgc8724a0">
<p>
一些有用的基础库。
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package dash f s ts ht diminish
                 nerd-icons hydra)
  (:doc "Useful tools"))</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-基本设置" class="outline-3">
<h3 id="基本设置"><a href="#基本设置">基本设置</a></h3>
<div class="outline-text-3" id="text-org32656f5">
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup delsel
  (:doc "Delete selection if you insert")
  (:with-mode delete-selection-mode
    (:hook-into after-init)))

(setup savehist
  (:doc "Save minibuffer history")
  (:option savehist-additional-variables
           '(mark-ring
             global-mark-ring
             search-ring
             regexp-search-ring
             extended-command-history)

           savehist-autosave-interval 300
           history-length 1000
           kill-ring-max 300
           history-delete-duplicates t)
  (:hook-into minibuffer-setup))

(setup saveplace
  (:doc "automatically save place in files")
  (:with-hook find-file-hook
    (:hook save-place-mode)))

(setup autorevert
  (:doc "Revert buffers when files on disk change")
  (:with-hook find-file-hook
    (:hook global-auto-revert-mode)))

(setup keys
  (:doc "Basic key settings.")
  ;; (:disabled)
  (:global
   "C-h" backward-char
           "C-j" next-line
           "C-k" previous-line
           "C-l" forward-char
           "C-e" backward-word
           "C-r" forward-word

           "C-w" kill-ring-save
           "M-w" kill-region
           "M-r" scroll-up-command
           "M-e" scroll-down-command            
           "C-z" undo
           "M-z" undo-redo            
           "C-t" recenter-top-bottom
           "M-t" move-to-window-line-top-bottom
           "C-q" comment-line
           "C-s" save-buffer
           "C-p" help-command
           )
  )</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-模态编辑" class="outline-3">
<h3 id="模态编辑"><a href="#模态编辑">模态编辑</a></h3>
<div class="outline-text-3" id="text-org3fbfa3e">
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package modalka)
  (:doc "Modal editing your way")
  (:disabled)
  (:require modalka)
  (modalka-define-kbd "1" "C-1")
  (modalka-define-kbd "2" "C-2")
  (modalka-define-kbd "3" "C-3")
  (modalka-define-kbd "4" "C-4")
  (modalka-define-kbd "5" "C-5")
  (modalka-define-kbd "6" "C-6")
  (modalka-define-kbd "7" "C-7")
  (modalka-define-kbd "8" "C-8")
  (modalka-define-kbd "9" "C-9")
  (modalka-define-kbd "0" "C-0")
  (modalka-define-kbd "-" "C--")
  (modalka-define-kbd "u" "C-u")

  (:bind "SPC" set-mark-command
         "c" (symbol-value 'mode-specific-map)
         "x" (symbol-value 'ctl-x-map)
         ;; "m"
         )


  ;; (modalka-define-kbd "c" "C-c")

  ;; (modalka-define-kbd "w" "C-w")
  ;; (modalka-define-kbd "y" "C-y")

  ;; (define-key modalka-mode-map (kbd "c") mode-specific-map)
  ;; (define-key modalka-mode-map (kbd "x") ctl-x-map)

  ;; (:bind "c" mode-specific-map)
  ;; (global-set-key '[8711] (kbd "&lt;escape&gt;"))
  (global-set-key '[8711] #'modalka-mode)

  (:option modalka-excluded-modes
           '(inferior-emacs-lisp-mode))
  (modalka-global-mode 1)
  (:diminish " @ ")
  )</code>
</pre>

</div>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package meow)
  (:doc "Meow is yet another modal editing mode for Emacs.")
  (:disabled)
  (:require meow)
  (defun meow-setup ()
    (setq meow-cheatsheet-layout meow-cheatsheet-layout-qwerty)
    (meow-motion-overwrite-define-key
     '("j" . meow-next)
     '("k" . meow-prev)
     '("&lt;escape&gt;" . ignore))
    (meow-leader-define-key
     ;; SPC j/k will run the original command in MOTION state.
     '("j" . "H-j")
     '("k" . "H-k")
     ;; Use SPC (0-9) for digit arguments.
     '("1" . meow-digit-argument)
     '("2" . meow-digit-argument)
     '("3" . meow-digit-argument)
     '("4" . meow-digit-argument)
     '("5" . meow-digit-argument)
     '("6" . meow-digit-argument)
     '("7" . meow-digit-argument)
     '("8" . meow-digit-argument)
     '("9" . meow-digit-argument)
     '("0" . meow-digit-argument)
     '("/" . meow-keypad-describe-key)
     '("?" . meow-cheatsheet))
    (meow-normal-define-key
     '("0" . meow-expand-0)
     '("9" . meow-expand-9)
     '("8" . meow-expand-8)
     '("7" . meow-expand-7)
     '("6" . meow-expand-6)
     '("5" . meow-expand-5)
     '("4" . meow-expand-4)
     '("3" . meow-expand-3)
     '("2" . meow-expand-2)
     '("1" . meow-expand-1)
     '("-" . negative-argument)
     '(";" . meow-reverse)
     '("," . meow-inner-of-thing)
     '("." . meow-bounds-of-thing)
     '("[" . meow-beginning-of-thing)
     '("]" . meow-end-of-thing)
     '("a" . meow-append)
     '("A" . meow-open-below)
     '("b" . meow-back-word)
     '("B" . meow-back-symbol)
     '("c" . meow-change)
     '("d" . meow-delete)
     '("D" . meow-backward-delete)
     '("e" . meow-next-word)
     '("E" . meow-next-symbol)
     '("f" . meow-find)
     '("g" . meow-cancel-selection)
     '("G" . meow-grab)
     '("h" . meow-left)
     '("H" . meow-left-expand)
     '("i" . meow-insert)
     '("I" . meow-open-above)
     '("j" . meow-next)
     '("J" . meow-next-expand)
     '("k" . meow-prev)
     '("K" . meow-prev-expand)
     '("l" . meow-right)
     '("L" . meow-right-expand)
     '("m" . meow-join)
     '("n" . meow-search)
     '("o" . meow-block)
     '("O" . meow-to-block)
     '("p" . meow-yank)
     '("q" . meow-quit)
     '("Q" . meow-goto-line)
     '("r" . meow-replace)
     '("R" . meow-swap-grab)
     '("s" . meow-kill)
     '("t" . recenter-top-bottom)
     '("T" . move-to-window-line-top-bottom)
     '("u" . meow-undo)
     '("U" . meow-undo-in-selection)
     '("v" . meow-visit)
     '("w" . meow-mark-word)
     '("W" . meow-mark-symbol)
     '("x" . meow-line)
     '("X" . meow-goto-line)
     '("y" . meow-save)
     '("Y" . meow-sync-grab)
     '("z" . meow-pop-selection)
     '("'" . repeat)
     '("&lt;escape&gt;" . ignore)))
  (global-set-key '[8711] (kbd "&lt;escape&gt;"))
  (meow-setup)
  (meow-global-mode 1))</code>
</pre>

</div>
</div>
</div>
<div id="outline-container-Minibuffer" class="outline-3">
<h3 id="Minibuffer"><a href="#Minibuffer">Minibuffer</a></h3>
<div class="outline-text-3" id="text-orga7d1957">
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup minibuffer
  (:doc "Settings on minibuffer.")
  (:bind "C-j" next-line)
  (:with-hook minibuffer-setup-hook
    (:hook (lambda ()
             (when (eq this-command 'eval-expression)
               (corfu-mode t)
               (smartparens-mode t))))))</code>
</pre>

</div>
</div>
</div>
</div>

<div id="outline-container-外观设置" class="outline-2">
<h2 id="外观设置"><a href="#外观设置">外观设置</a></h2>
<div class="outline-text-2" id="text-orge4d7683">
</div>
<div id="outline-container-字体设置" class="outline-3">
<h3 id="字体设置"><a href="#字体设置">字体设置</a></h3>
<div class="outline-text-3" id="text-org79b9a1b">
<p>
Nerd Font 的一个图标占两个字母，如果用 Nerd Font Mono 则是占一个字母。
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup faces
  (:doc "Faces setting")
  ;; (setup (:package ligature))
  (:with-hook window-setup-hook
    (:hook (lambda ()
             ;; default
             (set-face-attribute 'default nil :font "FantasqueSansM Nerd Font 14")
             ;; (set-face-attribute 'default nil :font "Fira Code 14")
             ;; unicode
             (set-fontset-font t 'unicode "WenQuanYi Zen Hei Mono 16")
             ;; emoji
             (set-fontset-font t 'emoji "Noto Color Emoji 14")
             ;; cn
             (set-fontset-font t 'han (font-spec
                                       :family "LXGW WenKai Mono 15"
                                       :size 20))
             ;; (ligature-set-ligatures 't
             ;;            '(;; == === ==== =&gt; =| =&gt;&gt;=&gt;=|=&gt;==&gt;&gt; ==&lt; =/=//=// =~
             ;;              ;; =:= =!=
             ;;              ("=" (rx (+ (or "&gt;" "&lt;" "|" "/" "~" ":" "!" "="))))
             ;;              ;; ;; ;;;
             ;;              (";" (rx (+ ";")))
             ;;              ;; &amp;&amp; &amp;&amp;&amp;
             ;;              ("&amp;" (rx (+ "&amp;")))
             ;;              ;; !! !!! !. !: !!. != !== !~
             ;;              ("!" (rx (+ (or "=" "!" "\." ":" "~"))))
             ;;              ;; ?? ??? ?:  ?=  ?.
             ;;              ("?" (rx (or ":" "=" "\." (+ "?"))))
             ;;              ;; %% %%%
             ;;              ("%" (rx (+ "%")))
             ;;              ;; |&gt; ||&gt; |||&gt; ||||&gt; |] |} || ||| |-&gt; ||-||
             ;;              ;; |-&gt;&gt;-||-&lt;&lt;-| |- |== ||=||
             ;;              ;; |==&gt;&gt;==&lt;&lt;==&lt;=&gt;==//==/=!==:===&gt;
             ;;              ("|" (rx (+ (or "&gt;" "&lt;" "|" "/" ":" "!" "}" "\]"
             ;;                              "-" "=" ))))
             ;;              ;; \\ \\\ \/
             ;;              ("\\" (rx (or "/" (+ "\\"))))
             ;;              ;; ++ +++ ++++ +&gt;
             ;;              ("+" (rx (or "&gt;" (+ "+"))))
             ;;              ;; :: ::: :::: :&gt; :&lt; := :// ::=
             ;;              (":" (rx (or "&gt;" "&lt;" "=" "//" ":=" (+ ":"))))
             ;;              ;; // /// //// /\ /* /&gt; /===:===!=//===&gt;&gt;==&gt;==/
             ;;              ("/" (rx (+ (or "&gt;"  "&lt;" "|" "/" "\\" "\*" ":" "!"
             ;;                              "="))))
             ;;              ;; .. ... .... .= .- .? ..= ..&lt;
             ;;              ("\." (rx (or "=" "-" "\?" "\.=" "\.&lt;" (+ "\."))))
             ;;              ;; -- --- ---- -~ -&gt; -&gt;&gt; -| -|-&gt;--&gt;&gt;-&gt;--&lt;&lt;-|
             ;;              ("-" (rx (+ (or "&gt;" "&lt;" "|" "~" "-"))))
             ;;              ;; *&gt; */ *)  ** *** ****
             ;;              ("*" (rx (or "&gt;" "/" ")" (+ "*"))))
             ;;              ;; www wwww
             ;;              ("w" (rx (+ "w")))
             ;;              ;; &lt;&gt; &lt;!-- &lt;|&gt; &lt;: &lt;~ &lt;~&gt; &lt;~~ &lt;+ &lt;* &lt;$ &lt;/  &lt;+&gt; &lt;*&gt;
             ;;              ;; &lt;$&gt; &lt;/&gt; &lt;|  &lt;||  &lt;||| &lt;|||| &lt;- &lt;-| &lt;-&lt;&lt;-|-&gt; &lt;-&gt;&gt;
             ;;              ;; &lt;&lt;-&gt; &lt;= &lt;=&gt; &lt;&lt;==&lt;&lt;==&gt;=|=&gt;==/==//=!==:=&gt;
             ;;              ;; &lt;&lt; &lt;&lt;&lt; &lt;&lt;&lt;&lt;
             ;;              ("&lt;" (rx (+ (or "\+" "\*" "\$" "&lt;" "&gt;" ":" "~"  "!"
             ;;                              "-"  "/" "|" "="))))
             ;;              ;; &gt;: &gt;- &gt;&gt;- &gt;--|-&gt; &gt;&gt;-|-&gt; &gt;= &gt;== &gt;&gt;== &gt;=|=:=&gt;&gt;
             ;;              ;; &gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt;&gt;
             ;;              ("&gt;" (rx (+ (or "&gt;" "&lt;" "|" "/" ":" "=" "-"))))
             ;;              ;; #: #= #! #( #? #[ #{ #_ #_( ## ### #####
             ;;              ("#" (rx (or ":" "=" "!" "(" "\?" "\[" "{" "_(" "_"
             ;;                           (+ "#"))))
             ;;              ;; ~~ ~~~ ~=  ~-  ~@ ~&gt; ~~&gt;
             ;;              ("~" (rx (or "&gt;" "=" "-" "@" "~&gt;" (+ "~"))))
             ;;              ;; __ ___ ____ _|_ __|____|_
             ;;              ("_" (rx (+ (or "_" "|"))))
             ;;              ;; Fira code: 0xFF 0x12
             ;;              ("0" (rx (and "x" (+ (in "A-F" "a-f" "0-9")))))
             ;;              ;; Fira code:
             ;;              "Fl"  "Tl"  "fi"  "fj"  "fl"  "ft"
             ;;              ;; The few not covered by the regexps.
             ;;              "{|"  "[|"  "]#"  "(*"  "}#"  "$&gt;"  "^="))
             ;; (global-ligature-mode t)
             )))


  )</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-主题设置" class="outline-3">
<h3 id="主题设置"><a href="#主题设置">主题设置</a></h3>
<div class="outline-text-3" id="text-orge1feaa4">
<p>
白天用朴素的 One Light, 晚上用 Dracula. Dracula Theme 的忠实粉丝就是我了，恨不得整个操作系统都用上。
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package circadian one-themes dracula-theme)
  (:doc "theme settings")
  (:option circadian-themes '(("7:00" . one-light)
                              ("19:00" . dracula)))
  ;; (load-theme 'dracula t)
  (circadian-setup))</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-状态栏" class="outline-3">
<h3 id="状态栏"><a href="#状态栏">状态栏</a></h3>
<div class="outline-text-3" id="text-org020672f">
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup modeline
  (:doc "Custom mode line")
  (:after nerd-icons
    (:option (prepend* nerd-icons-mode-icon-alist)
             '((messages-buffer-mode nerd-icons-octicon "nf-oct-log")
               (newsticker-treeview-mode nerd-icons-faicon "nf-fa-rss")
               (newsticker-treeview-list-mode nerd-icons-faicon "nf-fa-rss")
               (newsticker-treeview-item-mode nerd-icons-faicon "nf-fa-rss")
               (nov-mode nerd-icons-codicon "nf-cod-book")
               (yuck-mode nerd-icons-sucicon "nf-custom-common_lisp")
               (typst-ts-mode nerd-icons-faicon "nf-fa-tumblr_square"))

             (prepend* nerd-icons-extension-icon-alist)
             '(("yuck" nerd-icons-sucicon "nf-custom-common_lisp")
               ("db" nerd-icons-faicon "nf-fa-database")))
    )

  (defcustom setup--icon-for-file
    '(("books.org" nerd-icons-mdicon "nf-md-bookshelf")
      ("20230617T173209--emacs-配置__page_emacs.org" nerd-icons-sucicon "nf-seti-config"))
    "mode line file icons")

  (defun setup--icon ()
    (let* ((buf (buffer-name))
           (icon (cdr (assoc buf setup--icon-for-file))))
      (if icon
          (apply (car icon) (cdr icon))
        (nerd-icons-icon-for-mode major-mode))))

  (:option
   mode-line-format
   '("%e"
     (winum-mode (:eval
                  (propertize
                   (format winum-format (winum-get-number-string))
                   'face (let ((colored (face-attribute
                                         'font-lock-constant-face :foreground))
                               (colorless (face-attribute
                                           'default :background)))
                           ;; (message "%s" (window-buffer))
                           ;; (message "%s" (current-buffer))
                           ;; (message "%s" (eq (window-buffer) (current-buffer)))
                           (if (eq (window-buffer) (current-buffer))
                               (list :background colored :foreground colorless)
                             (list :background colorless :foreground colored))))))
     (select-mode (:eval (propertize " [S]"
                                     'face `(:foreground
                                             ,(face-attribute
                                               'font-lock-string-face :foreground)))))
     " "
     mode-line-mule-info
     (:eval (propertize "%*%+"
                        'face `(:foreground
                                ,(face-attribute
                                  (cond
                                   (buffer-read-only 'error)
                                   ((buffer-modified-p) 'warning)
                                   (t 'default))
                                  :foreground))))
     "  "
     (:eval (propertize (setup--icon)
                        'face `(:foreground
                                ,(face-attribute 'font-lock-negation-char-face :foreground)
                                )
                        'help-echo (lambda (&amp;rest _) (format "%s" major-mode))))
     "  "
     (:eval
      (propertize
       (let ((buffile (buffer-file-name)))
         (if (and buffile
                  (string-prefix-p (expand-file-name denote-directory) 
                                   buffile)
                  (denote-filename-is-note-p buffile))
             (denote-retrieve-filename-title buffile)
           (buffer-name)))
       'face 'font-lock-keyword-face))

     "  "
     mode-line-percent-position
     ;; (vc-mode vc-mode)
     " "
     (list "("
           ("" minor-mode-alist)
           ")")
     mode-line-misc-info
     mode-line-end-spaces))
  )</code>
</pre>

</div>
</div>
</div>
</div>
<div id="outline-container-编辑设置" class="outline-2">
<h2 id="编辑设置"><a href="#编辑设置">编辑设置</a></h2>
<div class="outline-text-2" id="text-org2fe6e0d">
</div>
<div id="outline-container-基本编辑操作" class="outline-3">
<h3 id="基本编辑操作"><a href="#基本编辑操作">基本编辑操作</a></h3>
<div class="outline-text-3" id="text-orgc6ad784">
<p>
定义了包括光标移动、复制粘贴、选择删除等一系列相关操作，以及快捷键定义。
</p>
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup simple
  (:doc "Basic editing commands for Emacs")
  (:option tab-width 4
           tab-always-indent 'complete
           indent-tabs-mode nil
           global-visual-line-mode t)

  (:with-mode visual-line-mode
    (:diminish))

  (fset 'yes-or-no-p 'y-or-n-p)

  (defun dust/newline-and-indent-1 ()
    (interactive)
    (end-of-line)
    (newline-and-indent))
  (defun dust/newline-and-indent-2 ()
    (interactive)
    (beginning-of-line)
    (newline-and-indent)
    (previous-line))

  (defun dust/forward-word (&amp;optional N)
    (interactive "P")
    (forward-word N))
  (defun dust/backward-word (&amp;optional N)
    (interactive "P")
    (backward-word))

  (defun dust/beginning-of-line ()
    (interactive)
    (beginning-of-line))
  (defun dust/end-of-line ()
    (interactive)
    (end-of-line))

  (defun dust/select-next-word (&amp;optional N)
    (interactive "p")
    (when (use-region-p)
      (keyboard-escape-quit))
    (set-mark-command nil)
    (dust/forward-word N))
  (defun dust/select-previous-word (&amp;optional N)
    (interactive "p")
    (dust/select-next-word (- (or N 1))))

  (defun dust/select-word-at-point ()
    (interactive)
    (dust/forward-word) ; in case at the beginning of word
    (dust/backward-word) ; 
    (dust/select-next-word))
  (defun dust/select-line (&amp;optional N)
    (interactive)
    (when (use-region-p)
      (keyboard-escape-quit))
    (dust/beginning-of-line)
    (set-mark-command nil)
    (move-end-of-line N))

  (defun dust/select-to-beginning-of-line ()
    (interactive)
    (when (use-region-p)
      (keyboard-escape-quit))
    (set-mark-command nil)
    (dust/beginning-of-line))
  (defun dust/select-to-end-of-line ()
    (interactive)
    (when (use-region-p)
      (keyboard-escape-quit))
    (set-mark-command nil)
    (dust/end-of-line))

  (defun dust/delete-previous-word (&amp;optional N)
    (interactive "P")
    (dust/select-previous-word N)
    (delete-active-region))

  (defun dust/delete-next-word (&amp;optional N)
    (interactive "P")
    (dust/select-next-word N)
    (delete-active-region))

  (defun dust/delete-word-at-point ()
    (interactive)
    (dust/select-word-at-point)
    (delete-active-region))

  (defun dust/delete-line (&amp;optional N)
    (interactive "p")
    (dust/select-line N)
    (delete-active-region))

  (defun dust/delete-to-beginning-of-line ()
    (interactive)
    (dust/select-to-beginning-of-line)
    (delete-active-region))
  (defun dust/delete-to-end-of-line ()
    (interactive)
    (dust/select-to-end-of-line)
    (delete-active-region))

  (define-prefix-command 'dust/select-map)
  (define-prefix-command 'dust/delete-map)
  (define-prefix-command 'dust/find-map)

  (:global "C-a" dust/beginning-of-line
           "C-b" dust/end-of-line
           "C-r" dust/forward-word
           "C-e" dust/backward-word
           "C-&lt;backspace&gt;" dust/delete-previous-word
           "C-&lt;delete&gt;" dust/delete-next-word
           "C-o" dust/newline-and-indent-1
           "M-o" dust/newline-and-indent-2)

  (:with-map dust/select-map
    (:bind
     ;; "C-v" set-mark-command
     "C-h" mark-whole-buffer
     "C-d" dust/select-word-at-point
     "C-r" dust/select-next-word
     "C-e" dust/select-previous-word
     "C-l" dust/select-line
     "C-a" dust/select-to-beginning-of-line
     "C-b" dust/select-to-end-of-line))
  (:with-map dust/delete-map
    (:bind
     "C-d" dust/delete-word-at-point
     "C-r" dust/delete-next-word
     "C-e" dust/delete-previous-word
     "C-l" dust/delete-line
     "C-a" dust/delete-to-beginning-of-line
     "C-b" dust/delete-to-end-of-line))

  (:global
   ;; "C-v" dust/select-map
   ;; "C-d" dust/delete-map
   "C-f" dust/find-map
   )
  )</code>
</pre>

</div>
</div>
</div>
<div id="outline-container-Select mode" class="outline-3">
<h3 id="Select mode"><a href="#Select mode">Select mode</a></h3>
<div class="outline-text-3" id="text-org75ad705">
<p>
快速进入选择模式，在选择模式下的一些快捷键。
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup select-mode
  (:doc "shortcuts in select mode")
  (:load-path "~/Repository/select-mode")
  (autoload 'global-select-mode "select-mode")
  (global-select-mode)
  (:global "C-v" set-mark-command))</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-窗口设置" class="outline-3">
<h3 id="窗口设置"><a href="#窗口设置">窗口设置</a></h3>
<div class="outline-text-3" id="text-org64490ee">
</div>
<div id="outline-container-窗口分割" class="outline-4">
<h4 id="窗口分割"><a href="#窗口分割">窗口分割</a></h4>
<div class="outline-text-4" id="text-orgf1d11b9">
<p>
选择 buffer, 水平或垂直分隔。
</p>
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup window
  (:doc "Operations about windows")
  (defun dust/split-window-right (buffer)
    (interactive "bChoose buffer: \n")
    (select-window (split-window-right))
    (switch-to-buffer buffer))
  (defun dust/split-window-below (buffer)
    (interactive "bChoose buffer: \n")
    (select-window (split-window-below))
    (switch-to-buffer buffer))
  (:global "C-x 2" dust/split-window-below
           "C-x 3" dust/split-window-right)
  )</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-窗口间移动" class="outline-4">
<h4 id="窗口间移动"><a href="#窗口间移动">窗口间移动</a></h4>
<div class="outline-text-4" id="text-org0a2b7ee">
<p>
使用数字编号在窗口间快速移动。
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package winum)
  (:doc "Navigate Emacs windows and frames using numbers ")
  (:hook-into window-setup-hook)
  (:global "M-0" winum-select-window-0
           "M-1" winum-select-window-1
           "M-2" winum-select-window-2
           "M-3" winum-select-window-3
           "M-4" winum-select-window-4
           "M-5" winum-select-window-5
           "M-6" winum-select-window-6
           "M-7" winum-select-window-7
           "M-8" winum-select-window-8
           "M-9" winum-select-window-9)
  (:option winum-auto-assign-0-to-minibuffer t
           ;; use custom modeline
           winum-auto-setup-mode-line nil
           ))</code>
</pre>

</div>
</div>
</div>
</div>

<div id="outline-container-括号增强" class="outline-3">
<h3 id="括号增强"><a href="#括号增强">括号增强</a></h3>
<div class="outline-text-3" id="text-orge5aecdc">
</div>
<div id="outline-container-高亮括号" class="outline-4">
<h4 id="高亮括号"><a href="#高亮括号">高亮括号</a></h4>
<div class="outline-text-4" id="text-orged0b9d5">
<p>
高亮包围当前光标位置的括号，并用方框标识。
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup paren
  (:doc "Highlight matching paren")
  (:with-mode show-paren-mode
    (:hook-into prog-mode))
  (:option show-paren-delay 0
           show-paren-context-when-offscreen t)
  (:advice show-paren-function :around (fn)
    (cond ((looking-at-p "\\s(") (funcall fn))
          (t (save-excursion
               (ignore-errors (backward-up-list))
               (funcall fn))))))</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-Smart Parens" class="outline-4">
<h4 id="Smart Parens"><a href="#Smart Parens">Smart Parens</a></h4>
<div class="outline-text-4" id="text-org452e190">
<p>
增强版的 electric-pair-mode, 同时提供了一些基于括号的操作，参见<a target="_blank" href="https://ebzzry.com/en/emacs-pairs/">Emacs and Pairs</a>.
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package smartparens)
  (:doc "A minor mode for dealing with pairs in Emacs.")

  (:with-hook window-setup-hook
    (:hook (lambda ()
             (require 'smartparens-config)
             (smartparens-global-mode t))))

  (:with-mode turn-on-smartparens-strict-mode
    (:hook-into prog-mode))

  (:when-loaded
    (:diminish)

    ;; Parens in Org Mode
    (sp-with-modes 'org-mode
      (sp-local-pair "$" "$"))

    ;; Parens in Typst ts mode
    (sp-with-modes '(typst-mode typst-ts-mode)
      (sp-local-pair "$" "$")

      )

    (:bind
     "M-a" sp-beginning-of-sexp
     "M-b" sp-end-of-sexp

     "M-s" sp-backward-up-sexp
     "M-d" sp-down-sexp

     "M-\\" sp-unwrap-sexp
     "M-]" sp-forward-slurp-sexp
     "M-[" sp-backward-slurp-sexp
     "M-{" sp-forward-barf-sexp
     "M-}" sp-backward-barf-sexp

     "M-m" sp-select-next-thing
     "C-d C-l" sp-kill-whole-line
     "C-d C-d" sp-kill-sexp

     "M-j" sp-next-sexp
     "M-k" sp-previous-sexp
     "M-l" sp-forward-symbol
     "M-h" sp-backward-symbol))
  )</code>
</pre>

</div>
</div>
</div>
</div>

<div id="outline-container-补全增强" class="outline-3">
<h3 id="补全增强"><a href="#补全增强">补全增强</a></h3>
<div class="outline-text-3" id="text-org94e15e5">
</div>
<div id="outline-container-补全前端" class="outline-4">
<h4 id="补全前端"><a href="#补全前端">补全前端</a></h4>
<div class="outline-text-4" id="text-org7cde837">
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package corfu)
  (:doc "Corfu enhances in-buffer completion with a small completion popup.")
  (:also-load corfu-popupinfo corfu-history)
  (:option corfu-cycle t
           corfu-auto t
           corfu-auto-delay 0
           corfu-auto-prefix 1
           corfu-popupinfo-delay 0)
  (:bind
    "C-r" corfu-scroll-down
    "C-e" corfu-scroll-up
    "C-j" corfu-next
    "C-k" corfu-previous
    "M-n" corfu-popupinfo-scroll-up
    "M-p" corfu-popupinfo-scroll-down)  
  (:hook corfu-popupinfo-mode corfu-history-mode)
  (:hook-into prog-mode ielm-mode))

(setup (:package nerd-icons-corfu)
  (:after corfu
    (:option (append corfu-margin-formatters) 'nerd-icons-corfu-formatter)))</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-补全后端" class="outline-4">
<h4 id="补全后端"><a href="#补全后端">补全后端</a></h4>
<div class="outline-text-4" id="text-orgfdc3a44">
<p>
cape 提供了多种补全后端。
</p>
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package cape)
  (:doc "Completion At Point Extensions")
  (:option (append completion-at-point-functions) 'cape-file
           (append completion-at-point-functions) 'cape-dabbrev))</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-补全模版" class="outline-4">
<h4 id="补全模版"><a href="#补全模版">补全模版</a></h4>
<div class="outline-text-4" id="text-org63060df">
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package tempel)
  (:doc "A tiny template package for Emacs")
  (:global "C-=" tempel-complete))</code>
</pre>

</div>

<p>
模板：
</p>
<div class="org-src-container">
<pre>
<code class="language-elisp">python-mode python-ts-mode

(name "if __name__ == \"__main__\":" n&gt;)</code>
</pre>

</div>
</div>
</div>
</div>

<div id="outline-container-Minibuffer 增强" class="outline-3">
<h3 id="Minibuffer 增强"><a href="#Minibuffer 增强">Minibuffer 增强</a></h3>
<div class="outline-text-3" id="text-org0742906">
<p>
新三件套 (vertico, orderless, consult)
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package vertico)
  (:doc "a performant and minimalistic vertical completion UI")
  (:also-load vertico-directory vertico-mouse)
  (:option vertico-scroll-margin 0
           vertico-cycle t
           vertico-resize t)
  (:hook-into pre-command)
  (:hook vertico-mouse-mode)
  (:with-map vertico-map
    (:bind "RET" vertico-directory-enter
           "DEL" vertico-directory-delete-char
           "C-DEL" vertico-directory-delete-word
           "M-DEL" vertico-directory-up)))

(setup (:package orderless)
  (:doc "An orderless completion style.")  
  (:option completion-styles '(orderless
                               substring
                               partial-completion
                               basic)
           completion-category-defaults nil
           completion-category-overrides nil
           completion-category-defaults nil
           completion-category-overrides '((file (styles . (partial-completion))))))

(setup (:package marginalia)
  (:doc "Add marginalia to the minibuffer completions.")
  (:hook-into vertico-mode))

(setup (:package nerd-icons-completion)
  (:doc "Add icons to completion candidates")
  (:hook-into marginalia-mode))

(setup (:package embark)
  (:doc "Make it easy to choose a command to run based on what is near point")
  (:option prefix-help-command #'embark-prefix-help-command

           (append display-buffer-alist)
           '("\\`\\*Embark Collect \\(Live\\|Completions\\)\\*"
             nil
             (window-parameters (mode-line-format . none))))
  (:global  "C-/" embark-act
            "C-?" embark-dwim)
  )

(setup (:package consult embark-consult)
  (:doc "Search and navigation commands based on the Emacs completion function")
  (:also-load consult-imenu)
  (:hook-into embark-collect-mode consult-preview-at-point-mode)
  (:global "C-f C-f" consult-line
           "C-f C-l" consult-goto-line
           "C-f C-m" consult-mark
           "C-f C-S-m" consult-global-mark
           "C-f C-d" consult-ripgrep
           "C-f C-s" consult-imenu)
  )</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-Isearch 增强" class="outline-3">
<h3 id="Isearch 增强"><a href="#Isearch 增强">Isearch 增强</a></h3>
<div class="outline-text-3" id="text-org8b6048e">
<p>
使用 phi-search, 支持 emacs-rime
</p>

<p>
我加了一个 hook 使得每次打开 phi-search 的时候都会自动输入上次搜索的字符串，然后选中。如果需要，直接 phi-search-next; 若不要，直接输入新字符即可。
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package phi-search)
  (:doc "Another incremental search &amp; replace")
  (:global "C-." phi-search
           "C-," phi-search-backward
       "C-f C-r" phi-replace-query)
  (:option phi-search-limit 10000)
  (defvar dust/phi-search--last-search nil)
  (defun dust/phi--insert-last-search ()
      "Use last search if no region actives."
      (when dust/phi-search--last-search
        (insert dust/phi-search--last-search)
        (mark-whole-buffer)))
  (:when-loaded
    (:advice phi-search--search-initialize :before (&amp;rest _)
      (unless (use-region-p)
        (setq dust/phi-search--last-search phi-search--last-executed))))

  (:with-function dust/phi--insert-last-search
    (:hook-into phi-search-init phi-replace-init)))</code>
</pre>

</div>
</div>
</div>
</div>

<div id="outline-container-编程" class="outline-2">
<h2 id="编程"><a href="#编程">编程</a></h2>
<div class="outline-text-2" id="text-org2f23a0f">
</div>
<div id="outline-container-显示" class="outline-3">
<h3 id="显示"><a href="#显示">显示</a></h3>
<div class="outline-text-3" id="text-org6e44430">
</div>
<div id="outline-container-行号" class="outline-4">
<h4 id="行号"><a href="#行号">行号</a></h4>
<div class="outline-text-4" id="text-org70d77d8">
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup display-line-numbers
  (:doc "Interface for display-line-numbers")
  (:option display-line-numbers-type 'relative)
  (:hook-into prog-mode)
  (:face line-number
    :slant 'italic)
  (:face line-number-current-line
    :foreground (face-attribute 'error :foreground)
    :background (face-attribute 'highlight :background)
    :weight 'bold
    :slant 'normal))</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-高亮当前行" class="outline-4">
<h4 id="高亮当前行"><a href="#高亮当前行">高亮当前行</a></h4>
<div class="outline-text-4" id="text-orgf1d121c">
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup hl-line
  (:doc "Highlight the current line")
  (:hook-into prog-mode))</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-彩色括号" class="outline-4">
<h4 id="彩色括号"><a href="#彩色括号">彩色括号</a></h4>
<div class="outline-text-4" id="text-org10e27b4">
<p>
对不同层次的括号使用不同颜色，对 Lisp 这种多重括号尤其有效。
</p>
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package rainbow-delimiters)
  (:doc "Highlight delimiters according to their depth.")
  (:hook-into prog-mode))</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-eldoc" class="outline-4">
<h4 id="eldoc"><a href="#eldoc">eldoc</a></h4>
<div class="outline-text-4" id="text-orge9de161">
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup eldoc
  (:doc "Show function arglist or variable docstring in echo area")
  (:diminish)
  (:option eldoc-echo-area-use-multiline-p nil))</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-缩进提示" class="outline-4">
<h4 id="缩进提示"><a href="#缩进提示">缩进提示</a></h4>
<div class="outline-text-4" id="text-org46c8e4b">
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package highlight-indent-guides)
  (:doc "This minor mode highlights indentation levels via font-lock.")
  (:diminish)
  (:hook-into prog-mode)
  (:option highlight-indent-guides-method 'character
           highlight-indent-guides-auto-enabled nil)
  (:face highlight-indent-guides-odd-face
    :foreground (face-attribute 'shadow :foreground))
  (:face highlight-indent-guides-even-face
    :foreground (face-attribute 'shadow :foreground))
  (:face highlight-indent-guides-character-face
    :foreground (face-attribute 'shadow :foreground)))</code>
</pre>

</div>
</div>
</div>
</div>

<div id="outline-container-移动到缩进行首" class="outline-3">
<h3 id="移动到缩进行首"><a href="#移动到缩进行首">移动到缩进行首</a></h3>
<div class="outline-text-3" id="text-orgfbed422">
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package mwim)
  (:doc "Operations of Cursor moving")
  (defalias 'dust/beginning-of-line 'mwim-beginning-of-code-or-line)
  (defalias 'dust/end-of-line 'mwim-end-of-code-or-line))</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-代码折叠" class="outline-3">
<h3 id="代码折叠"><a href="#代码折叠">代码折叠</a></h3>
<div class="outline-text-3" id="text-orgc9a7614">
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup hideshow
  (:doc "Minor mode cmds to selectively display code/comment blocks")
  (:with-mode hs-minor-mode
    (:diminish)
    (:hook-into prog-mode)
    (:bind "C-c C-v C-c" hs-toggle-hiding
           "C-c C-v C-h" hs-hide-block
           "C-c C-v C-s" hs-show-block
           "C-c C-v C-t" hs-hide-all
           "C-c C-v C-a" hs-show-all
           "C-c C-v C-l" hs-hide-level)))</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-Tree-sitter" class="outline-3">
<h3 id="Tree-sitter"><a href="#Tree-sitter">Tree-sitter</a></h3>
<div class="outline-text-3" id="text-org463de23">
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package treesit-auto)
  (:doc "A parser generator tool and an incremental parsing library.")
  (:disabled)
  (:require treesit-auto)
  (:option treesit-auto-install t)
  (treesit-auto-add-to-auto-mode-alist 'all)
  (global-treesit-auto-mode))</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-LSP" class="outline-3">
<h3 id="LSP"><a href="#LSP">LSP</a></h3>
<div class="outline-text-3" id="text-org088ec8d">
<p>
不搞开发，能用就行。不 hook <code>prog-mode</code> 的原因是写比如 elisp 就没必要启动用它。
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup eglot
  (:doc "A emacs LSP client")
  (:with-function eglot-ensure
    (:hook-into
     python-mode
     python-ts-mode
     yaml-mode
     yaml-ts-mode
     js-mode
     js-ts-mode
     mhtml-mode
     scss-mode)))</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-Python" class="outline-3">
<h3 id="Python"><a href="#Python">Python</a></h3>
<div class="outline-text-3" id="text-org7cbfdae">
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup python
  (:doc "Python's flying circus support for Emacs")
  (defcustom setup--python-venvs
    '(("~/pyproj" "~/.pydev/bin/jedi-language-server")
      ("~/.config/qtile" "~/.qtile/bin/jedi-language-server"))
    "Python virtual environment")
  (defun setup--python-lsp-server (_)
    (require 'f)
    (require 's)
    (let ((projdir (f-expand "~/pyproj"))
          (file-name (buffer-file-name))
          ret)
      (or 
       (when file-name
         (cdar (--filter
                (f-ancestor-of-p (car it) file-name)
                setup--python-venvs)))
       '("jedi-language-server"))))
  (:option python-indent-guess-indent-offset nil)
  (:after eglot
    (:option (prepend eglot-server-programs)
             '((python-mode python-ts-mode) . setup--python-lsp-server)))
  )</code>
</pre>

</div>
</div>
</div>
<div id="outline-container-YAML" class="outline-3">
<h3 id="YAML"><a href="#YAML">YAML</a></h3>
<div class="outline-text-3" id="text-org46edc58">
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package yaml-mode)
  (:doc "Support for YAML Language")
  (:file-match "\\.\\(yml\\|yaml\\)\\'"))</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-Emacs Lisp" class="outline-3">
<h3 id="Emacs Lisp"><a href="#Emacs Lisp">Emacs Lisp</a></h3>
<div class="outline-text-3" id="text-orgc4abc94">
</div>
<div id="outline-container-elisp-def" class="outline-4">
<h4 id="elisp-def"><a href="#elisp-def">elisp-def</a></h4>
<div class="outline-text-4" id="text-org843e715">
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package elisp-def)
  (:doc "Go to the definition of the symbol at point.")
  (:hook-into emacs-lisp-mode ielm-mode)
  (:diminish))</code>
</pre>

</div>
</div>
</div>
</div>

<div id="outline-container-Yuck" class="outline-3">
<h3 id="Yuck"><a href="#Yuck">Yuck</a></h3>
<div class="outline-text-3" id="text-org56ebd09">
<p>
Yuck 是窗口图形模块套件 <a target="_blank" href="https://elkowar.github.io/eww/">EWW</a> 的语言，基于 Lisp.
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package yuck-mode)
  (:doc "Emacs major mode for editing yuck configuration files")
  (:file-match "\\.\\(yuck\\)\\'"))</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-Sxhkd" class="outline-3">
<h3 id="Sxhkd"><a href="#Sxhkd">Sxhkd</a></h3>
<div class="outline-text-3" id="text-orgd251bf7">
<p>
bspwm 下的键盘映射配置。
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package (sxhkd-mode "https://github.com/xFA25E/sxhkd-mode"))
  (:doc "A major mode for editing sxhkdrc")
  (:file-match (rx "sxhkdrc" string-end)))</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-Jinja2" class="outline-3">
<h3 id="Jinja2"><a href="#Jinja2">Jinja2</a></h3>
<div class="outline-text-3" id="text-org7c97709">
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package jinja2-mode)
  (:doc "Jinja2 mode for emacs")
  (:file-match "\\.\\(jinja2\\)\\'"))</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-Markdown" class="outline-3">
<h3 id="Markdown"><a href="#Markdown">Markdown</a></h3>
<div class="outline-text-3" id="text-orgc2e98dd">
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package markdown-mode)
  (:doc "Support for Markdown")
  (:file-match "\\.md\\'"))</code>
</pre>

</div>
</div>
</div>
</div>

<div id="outline-container-Org mode" class="outline-2">
<h2 id="Org mode"><a href="#Org mode">Org mode</a></h2>
<div class="outline-text-2" id="text-orgab1ffeb">
<p>
Org mode 原本是一个基于 outline 的任务管理，但是因为提供了丰富的语言标记，以及结合 emacs 提供导出、发布等各种操作，它已然成为一个强大的笔记、管理、收集等集一体的系统。
</p>
</div>

<div id="outline-container-org mode 设置" class="outline-3">
<h3 id="org mode 设置"><a href="#org mode 设置">org mode 设置</a></h3>
<div class="outline-text-3" id="text-org9257ad8">
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup org
  (:doc "keeping notes, maintaining ToDo lists,"
        "and doing project planning")
  (:when-loaded
    (:option org-todo-keywords
             '((sequence "TODO(t)"
                         "DOING(i)"
                         "WAIT(w@/!)"
                         "|"
                         "DONE(d!)"
                         "CANCELED(c@)"))
             org-todo-keyword-faces
             '(("TODO" . (:background "red3" :foreground "white" :weight bold))
               ("DOING" . (:background "SteelBlue" :foreground "white" :weight bold))
               ("WAIT" . (:background "orange" :foreground "white" :weight bold))
               ("DONE" . (:background "SeaGreen4" :foreground "white" :weight bold))
               ("CANCELED" . (:foreground "#b6b6b2" :weight bold :strike-through "#b6b6b2"))))
    (:option org-edit-src-content-indentation 0
             ;; org-auto-align-tags nil
             org-tags-column 0
             org-use-sub-superscripts nil
             org-link-file-path-type 'relative
             org-startup-truncated t)

    (:bind "C-c e" org-edit-src-code
           "C-j" next-line
           "C-," phi-search-backward)

    (:face org-checkbox :box nil)
    (:face org-level-1 :weight 'semi-bold :height 1.6)
    (:face org-level-2 :weight 'semi-bold :height 1.45)
    (:face org-level-3 :weight 'semi-bold :height 1.3)
    (:face org-level-4 :weight 'semi-bold :height 1.15)
    (:face org-level-5 :weight 'semi-bold :height 1.0)
    (:face org-level-6 :weight 'semi-bold :height 1.0)

    (defhydra hydra-org-next-visible-heading ()
      "Go to org next/previous visible heading"
      ("n" org-next-visible-heading)
      ("p" org-previous-visible-heading))
    (defhydra hydra-org-previous-visible-heading ()
      "Go to org next/previous visible heading"
      ("n" org-next-visible-heading)
      ("p" org-previous-visible-heading))

    (:advice hydra-org-next-visible-heading/body :before (&amp;rest args)
      (org-next-visible-heading 1))
    (:advice hydra-org-previous-visible-heading/body :before (&amp;rest args)
      (org-previous-visible-heading 1))

    (:bind "C-c C-n" hydra-org-next-visible-heading/body
           "C-c C-p" hydra-org-previous-visible-heading/body)
    ))</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-快速改变 heading" class="outline-3">
<h3 id="快速改变 heading"><a href="#快速改变 heading">快速改变 heading</a></h3>
<div class="outline-text-3" id="text-org8c886df">
<p>
通过快捷键来快速调整 headline 等级。
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup dust/org-heading
  (:after org
    (:require s)
    (defun dust/org-headline-set (N)
      "Set org headline"
      (when (and (org-at-heading-p)
                 (/= N
                     (save-excursion
                       (beginning-of-line)
                       (length
                        (nth 1
                             (s-match org-heading-regexp
                                      (buffer-substring-no-properties
                                       (point)
                                       (+ (point) 10))))))))
        (org-toggle-heading))
      (when (and (&gt;= N 1)
                 (&lt;= N 6))
        (org-toggle-heading N)))
    (defun dust/org-headline-set-1 () (interactive) (dust/org-headline-set 1))
    (defun dust/org-headline-set-2 () (interactive) (dust/org-headline-set 2))
    (defun dust/org-headline-set-3 () (interactive) (dust/org-headline-set 3))
    (defun dust/org-headline-set-4 () (interactive) (dust/org-headline-set 4))
    (defun dust/org-headline-set-5 () (interactive) (dust/org-headline-set 5))
    (defun dust/org-headline-set-6 () (interactive) (dust/org-headline-set 6))

    (:bind
      "C-c h 1" dust/org-headline-set-1
      "C-c h 2" dust/org-headline-set-2
      "C-c h 3" dust/org-headline-set-3
      "C-c h 4" dust/org-headline-set-4
      "C-c h 5" dust/org-headline-set-5
      "C-c h 6" dust/org-headline-set-6))
  )</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-快速插入" class="outline-3">
<h3 id="快速插入"><a href="#快速插入">快速插入</a></h3>
<div class="outline-text-3" id="text-orgd762d58">
<ol class="org-ol">
<li>输入一个 URL, 尝试自动获取返回的 HTML 的 <code>&lt;title&gt;</code>, 如果有就把它作为 org-link 的 description. 或输入 denote 笔记，以它的标题作为 description.</li>
<li>给定一个存放图片的目录，按最近修改时间排序</li>
<li>按键录入</li>
</ol>
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup dust/org-insert
  (:after org
    (:require dash f)

    (defun dust/org-link--fetch-title-by-url (uri)
      (let (title)
        (with-current-buffer (url-retrieve-synchronously
                              uri t nil 10)
          (let* ((dom (libxml-parse-html-region
                       (point-min) (point-max))))
            (setq title 
                  (and dom
                       (dom-text (dom-by-tag dom 'title))))))
        (unless (or title
                    (length= title 0))
          (message "Failed to get title."))
        title))

    (defun dust/org-link-make-description-function (link desc)
      (let* ((tmp (string-split link ":")) 
             (protocol (car tmp))
             (path (string-join (cdr tmp) ":")))
        (pcase protocol
          ((or "http" "https")
           (dust/org-link--fetch-title-by-url link))
          ("denote"
           ;; TODO
           (denote-retrieve-title-value (denote-get-path-by-id path) 'org))
          (_ desc))))

    (:option org-link-make-description-function
             #'dust/org-link-make-description-function)


    (defun dust/org-insert-key-sequence ()
      "Insert key sequnce"
      (interactive)
      (insert (key-description
               (read-key-sequence-vector "Pressing... "))))

    (defcustom dust/org-image-directory "~/Note/assets"
      "Where the images are")

    (defun dust/org-image--sort-completion-table (images)
      (--sort (&gt;= (f-modification-time it 'seconds)
                  (f-modification-time other 'seconds))
              (f-files dust/org-image-directory)))


    (defun dust/org-insert-image ()
      "Insert image from Special directory into current buffer."
      (interactive)
      (let ((images (--sort (&gt;= (f-modification-time it 'seconds)
                                (f-modification-time other 'seconds))
                            (f-files dust/org-image-directory)))
            (cur-file (f-this-file))
            (completions-sort nil)
            (vertico-sort-function nil))
        (if (not cur-file)
            (message "Current buffer is not a file: %s" (buffer-name
                                                         (current-buffer)))
          (insert (format "[[file:%s]]\n"
                          (f-relative
                           (completing-read
                            "Insert image: "
                            (dust/org-image--sort-completion-table dust/org-image-directory)
                            ;; (dust/org-image--sort-completion-table images)
                            nil t)
                           (f-dirname cur-file)))))))

    (:with-map org-mode-map
      (:bind
        "C-c C-m" dust/org-insert-image
        "C-c M-k" dust/org-insert-key-sequence))))</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-Org Agenda" class="outline-3">
<h3 id="Org Agenda"><a href="#Org Agenda">Org Agenda</a></h3>
<div class="outline-text-3" id="text-org5e72556">
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup org-agenda
  (:doc "Org Agenda settings")
  (:global "C-\\" org-cycle-agenda-files)
  (:option org-agenda-files '("~/Agendas"))
  (:when-loaded

    (:option org-agenda-tags-column 0
             org-agenda-use-time-grid t
             org-agenda-time-grid '((daily today require-timed)
                                    (700 1200 1800 2300)
                                    "......"
                                    "----------------")
             org-agenda-start-with-follow-mode t
             org-agenda-skip-scheduled-if-done t)))</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-org mode 美化" class="outline-3">
<h3 id="org mode 美化"><a href="#org mode 美化">org mode 美化</a></h3>
<div class="outline-text-3" id="text-org7c76a0d">
</div>
<div id="outline-container-Org Modern" class="outline-4">
<h4 id="Org Modern"><a href="#Org Modern">Org Modern</a></h4>
<div class="outline-text-4" id="text-org099dab7">
<p>
通过 pretty entities 来美化各种标记。
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package org-modern)
  (:doc "a modern style for Org buffers.")
  (:hook-into org-mode)
  (:when-loaded
    (:with-function org-modern-agenda
      (:hook-into org-agenda-finalize))

    ;; Org prettify
    (:option org-auto-align-tags nil
             org-hide-emphasis-markers t
             org-pretty-entities nil
             org-ellipsis "...")
    ;; (:face org-tag :weight 'normal :foreground "#afeeee")
    (:face org-modern-label :height 1.0)
    (:face org-modern-statistics
      :background  (face-attribute 'default :background)
      :box nil)
    (:face org-modern-tag :box nil)

    (:option org-modern-star "*"
             org-modern-checkbox '((?X . "󰄵")
                                   (?- . "󰄗")
                                   (?\s . "󰄱"))
             org-modern-progress '("󰝦 " "󰪞 " "󰪟 " "󰪠 "
                                   "󰪡 " "󰪢 " "󰪣 " "󰪤" "󰪥 ")
             org-modern-todo nil
             org-modern-block-name '(("src" . (" " ""))
                                     ("quote" . (" " "")))
             org-modern-keyword '(("title" . "  ")
                                  ("date" . "")
                                  ("filetags" . "")
                                  ("identifier" . " ")
                                  ("options" . " ")
                                  ("location" . " ")
                                  ("caption" . " "))
             org-modern-list '((?+ . " ")
                               (?- . " ")
                               (?* . " ")))))</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-排版" class="outline-4">
<h4 id="排版"><a href="#排版">排版</a></h4>
<div class="outline-text-4" id="text-org0b1cb4f">
<p>
采用左右两侧留白，页面集中到中部的排版。
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package olivetti)
  (:doc "A simple Emacs minor mode for a nice writing environment.")
  (:diminish)
  (:option olivetti-body-width 110)
  (:hook-into org-mode typst-mode typst-ts-mode))</code>
</pre>

</div>
</div>
</div>
</div>

<div id="outline-container-Latex 相关" class="outline-3">
<h3 id="Latex 相关"><a href="#Latex 相关">Latex 相关</a></h3>
<div class="outline-text-3" id="text-org342beae">
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup org-latex
  (:doc "Org Latex Environment")
  (:option org-highlight-latex-and-related '(latex native))
  (:after org
    (:option org-latex-listings t
             org-latex-pdf-process
             '("xelatex -interaction nonstopmode -no-mktex=tex -output-directory %o %f"
               ;; "xelatex -interaction nonstopmode -output-directory %o %f"
               ;; "xelatex -interaction nonstopmode -output-directory %o %f"
               )
             org-latex-compiler "xelatex"
             (append org-latex-packages-alist) '("" "xeCJK"))
    ;; Beamer
    (:option org-beamer-frame-level 2
             org-beamer-outline-frame-title "Content")))</code>
</pre>

</div>
</div>
</div>
<div id="outline-container-快速查询" class="outline-3">
<h3 id="快速查询"><a href="#快速查询">快速查询</a></h3>
<div class="outline-text-3" id="text-org8ef9d87">
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package org-ql)
  (:doc "A query language for Org files.")
  (:after org-ql-view
    (:when-loaded
      (:bind
        "q" (lambda () (interactive) (quit-window t))))))</code>
</pre>

</div>
</div>
</div>
<div id="outline-container-Org Mobile" class="outline-3">
<h3 id="Org Mobile"><a href="#Org Mobile">Org Mobile</a></h3>
<div class="outline-text-3" id="text-org55420b6">
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup org-mobile
  (:doc "Asymmetric Sync With a Mobile Device")
  (autoload 'org-mobile-push "org-mobile"
    "Push the current state of Org affairs to the target directory." t)
  (autoload 'org-mobile-pull "org-mobile"
    "Pull the contents of `org-mobile-capture-file' and integrate them." t)
  (:option org-mobile-directory "/ssh:MyServer:/root/Org"))</code>
</pre>

</div>
</div>
</div>
</div>
<div id="outline-container-工具" class="outline-2">
<h2 id="工具"><a href="#工具">工具</a></h2>
<div class="outline-text-2" id="text-org3af06be">
</div>
<div id="outline-container-输入法" class="outline-3">
<h3 id="输入法"><a href="#输入法">输入法</a></h3>
<div class="outline-text-3" id="text-org572cce2">
<p>
Emacs 的 RIME 输入法，只要断言做得好，就可以丝滑地在中英文输入法之间切换，且不会影响快捷键的使用。
</p>

<p>
在激活了 emacs-rime 后退出 emacs 会进入一段时间的卡死状态，在 Issue <a target="_blank" href="https://github.com/DogLooksGood/emacs-rime/issues/161#issuecomment-979907791">#161</a> 中给出了一个方案，就是在 emacs 关闭时主动关闭 rime-lib. 这个函数是从 so 库里面都出来的，我找不到哪里可以 with-eval-after-load. 所以我用了一个 trick, 在激活输入法后给 <code>kill-emacs-hook</code> 加上 <code>rime-lib-finalize</code>.
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package rime)
  (:doc "RIME input method in Emacs")
  ;; (:require rime)
  (:option default-input-method "rime")

  (defun dust/rime-predicate-punctuation-after-space-cc-p ()
    (let* ((start (save-excursion
                    (re-search-backward
                     "[^\s]"
                     nil
                     t)))
           (string (buffer-substring
                    (if start start 1)
                    (point))))
      (string-match "\\cc +" string)))

  (defun dust/rime-predicate-org-in-src-block-p ()
    (and (derived-mode-p 'org-mode)
         (org-element-at-point)
         (org-src--on-datum-p (org-element-at-point))
         (org-in-src-block-p)))

  (:option rime-inline-ascii-trigger 'shift-l
           rime-show-preedit 'inline
           rime-show-candidate 'posframe
           rime-deactivate-when-exit-minibuffer nil)
  (:option rime-disable-predicates
           '(rime-predicate-prog-in-code-p
             dust/rime-predicate-punctuation-after-space-cc-p
             rime-predicate-after-alphabet-char-p
             dust/rime-predicate-org-in-src-block-p
             rime-predicate-org-latex-mode-p))

  (:face rime-default-face :background nil)
  (:option rime-posframe-properties nil)

  (defun dust/rime-finalize ()
    (add-hook 'kill-emacs-hook #'rime-lib-finalize)
    (remove-hook 'input-method-activate-hook #'dust/rime-finalize))
  (:with-hook input-method-activate-hook
    (:hook dust/rime-finalize))

  (:hook (lambda ()
           (when (rime--ascii-mode-p)
             (rime--inline-ascii))))
  (:global "C-&lt;SPC&gt;" toggle-input-method)
  )</code>
</pre>

</div>
</div>
</div>
<div id="outline-container-文件管理" class="outline-3">
<h3 id="文件管理"><a href="#文件管理">文件管理</a></h3>
<div class="outline-text-3" id="text-orgf831acd">
<p>
Dirvish 是一个非常优秀的文件管理器，优美的前端，集成 Dired, 它完全能够作为一个独立的基于命令行的文件管理器使用（我确实也是把它作为系统默认的文件管理器使用）
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package dirvish)
  (:doc "An improved version of the Emacs inbuilt package Dired")
  (:load-path "extensions")
  (:also-load dirvish-icons
              dirvish-emerge
              dirvish-quick-access
              dirvish-subtree
              subr-x)
  (:when-loaded
    (:option dirvish-quick-access-entries
             '(("h" "~/")
               ("e" "~/.emacs.d/")
               ("g" "~/gh-repo/")
               ("n" "~/Note/")
               ("G" "~/.emacs.d/etc/gnus/")))

    (:option dirvish-preview-dispatchers '(image gif audio archive))
    (dirvish-define-preview lsd (file)
      "Use `lsd' to generate directory preview."
      :require ("lsd") ; tell Dirvish to check if we have the executable
      (when (file-directory-p file) ; we only interest in directories here
        `(shell . ("lsd" "-al" "--icon" "never" ,file))))
    (:option (append dirvish-preview-dispatchers) 'lsd)

    (defun dust/dirvish--truncate-line (&amp;rest _)
      (setq-local truncate-lines t))

    (dirvish-emerge-define-predicate is-dir
      "If item is a directory"
      (equal (car type) 'dir))

    (:option dirvish-use-header-line nil
             dirvish-attributes '(subtree-state nerd-icons file-size)
             delete-by-moving-to-trash t
             dirvish-mode-line-height 21
             dirvish-redisplay-debounce 1
             dired-listing-switches
             "-l --almost-all --human-readable --group-directories-first --no-group --time-style=iso"

             dirvish-emerge-groups
             '(("Hidden" (regex . "^\\."))
               ("Directory" (predicate . is-dir))
               ("Documents" (extensions "pdf" "tex" "bib" "epub"))
               ("Video" (extensions "mp4" "mkv" "webm"))
               ("Picture" (extensions "jpg" "png" "svg" "gif"))
               ("Audio" (extensions "mp3" "flac" "wav" "ape" "aac"))
               ("Archive" (extensions "gz" "rar" "zip"))
               ("Org" (extensions "org"))
               ("Emacs Lisp" (extensions "el"))
               ("Python" (extensions "py"))
               ("Files" (regex . ".*"))))

    (:option dirvish-override-dired-mode t)

    (:with-hook dirvish-find-entry-hook
      (:hook dust/dirvish--truncate-line))
    (:with-mode dirvish-emerge-mode
      (:hook-into dirvish-setup))

    (:bind
      "a" dirvish-quick-access
      "j" dired-next-line
      "k" dired-previous-line
      "f" dired-goto-file
      "b" dired-up-directory
      "n" dirvish-emerge-next-group
      "p" dirvish-emerge-previous-group
      "TAB" dirvish-subtree-toggle
      "M-t" dirvish-layout-toggle
      "z" dired
      "SPC" dired-find-file))
  (:global "C-x C-d" dirvish)
  )</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-中文分词" class="outline-3">
<h3 id="中文分词"><a href="#中文分词">中文分词</a></h3>
<div class="outline-text-3" id="text-org07da4d8">
<p>
基于中文分词的词语移动。Emacs 内置的 forward-word/backward-word 遇上中文会直接跑到句子结束。用了 jieba 分词就可以实现中文词语的 forward/backward.
</p>

<p>
目前只在 org mode 下开启，我对于中文分词的需求也来源于 org mode.
</p>

<p>
jieba.el 在每个 Emacs 应用打开都会启动一个 node-js 的服务器，我想把 jieba.el 作前后端分离，在我的系统中只跑一个，所有客户端都连接它即可。一来减少内存占用，二来加快启动，这样就可以全局下开启 jieba mode 而不需要考虑拖慢启动时间。
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package (jieba "https://github.com/fingerknight/jieba.el"))
  (:doc "Things about selection and deletion supporting CN words")
  (:diminish)
  (defalias 'dust/forward-word 'jieba-forward-word)
  (defalias 'dust/backward-word 'jieba-backward-word)
  (defalias 'dust/select-word-at-point 'jieba-mark-word)
  (:option jieba-current-backend 'python)
  (:hook-into window-setup)
  )</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-大纲展示" class="outline-3">
<h3 id="大纲展示"><a href="#大纲展示">大纲展示</a></h3>
<div class="outline-text-3" id="text-org25f4541">
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package imenu-list)
  (:doc "A automatically updated buffer with imenu entries.")  
  (:global "C-'" imenu-list-smart-toggle)
  (:option imenu-list-focus-after-activation t
           imenu-list-position 'left
           imenu-list-size 0.2)
  (defun dust/imenu-list--truncate-line (&amp;rest _)
    (with-current-buffer (imenu-list-get-buffer-create)
      (setq-local truncate-lines t)))
  (:when-loaded
    (:with-hook imenu-list-after-jump-hook
      (:hook recenter-top-bottom))
    (:with-hook imenu-list-update-hook
      (:hook dust/imenu-list--truncate-line))))</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-摘抄库" class="outline-3">
<h3 id="摘抄库"><a href="#摘抄库">摘抄库</a></h3>
<div class="outline-text-3" id="text-org2f5aa44">
<p>
自己写的一个摘抄管理，用 sqlite3 数据库。
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package (excerpt "https://github.com/fingerknight/excerpt.el")
                 emacsql)
  (:doc "Excerpt management")
  (:option excerpt-dir (expand-file-name "~/Note"))
  )</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-音乐播放器" class="outline-3">
<h3 id="音乐播放器"><a href="#音乐播放器">音乐播放器</a></h3>
<div class="outline-text-3" id="text-org0ee5271">
<p>
MPD 的前端，其实还是用的 MPC, 所以它是 MPD 前端的前端。简单但够用。
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package simple-mpc)
  (:doc "A GNU Emacs major mode that acts as a front end to mpc.")
  (:option simple-mpc-playlist-format "%title%\t%artist%\t%time%"
           simple-mpc-table-separator "\t")
  (:when-loaded
    (defun dust/simple-mpc-load-playlist (playlist-name)
      "Rewrite load playlist such that:
1. Clean play list before loading;
2. Shuffle play lists after loading.
3. Show play list after loading."
      (interactive
       (list
        (completing-read "Playlist: " (simple-mpc-call-mpc-strings "lsplaylists"))))
      (simple-mpc-clear-current-playlist)
      (simple-mpc-call-mpc nil (list "load" playlist-name))
      (simple-mpc-shuffle-current-playlist)
      (simple-mpc-maybe-refresh-playlist)
      (simple-mpc-view-current-playlist))
    (defalias 'simple-mpc-load-playlist 'dust/simple-mpc-load-playlist)))</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-邮件与订阅" class="outline-3">
<h3 id="邮件与订阅"><a href="#邮件与订阅">邮件与订阅</a></h3>
<div class="outline-text-3" id="text-org0391eee">
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup gnus
  (:doc "A newsreader for GNU Emacs")
  (:option gnus-home-directory (expand-file-name "gnus" user-emacs-directory))
  (:when-loaded
    (:option (prepend auth-sources) (expand-file-name "authinfo" gnus-home-directory))
    (:option gnus-select-method '(nnimap
                                  "outlook"
                                  (nnimap-address "outlook.office365.com")
                                  (nnimap-server-port 993)
                                  (nnimap-stream ssl)))

    (:with-feature gnus-sum
      (:when-loaded
        (:option (prepend gnus-article-sort-functions) 'gnus-summary-sort-by-most-recent-date)))

    (:option gnus-permanently-visible-groups
             "nls_.+\\|Inbox\\|Sent\\|Junk\\|nnrss:.+"

             gnus-blocked-images nil)

    (defcustom dust/gnus-rss-list
      '(("iDaily" "https://rsshub.app/idaily/today")
        ("每日早报" "https://rsshub.app/readhub/daily")
        ("理想生活实验室" "https://rsshub.app/toodaylab/posts")
        ("少数派" "https://rsshub.app/sspai/index")
        ("纽约时报" "https://rsshub.app/nytimes/dual")
        ("Hacker News" "https://rsshub.app/hackernews")
        ("Bing 每日壁纸" "https://rsshub.app/bing")
        ("Emacs China" "https://emacs-china.org/latest.rss")
        ("Linux Links" "https://www.linuxlinks.com/feed/"))
      "RSS Feeds")

    (defun dust/gnus-rss ()
      (dolist (it dust/gnus-rss-list)
        (unless (gnus-group-entry (concat "nnrss:" (car it)))
          (let ((title (car it))
                (href (cadr it)))
            ;; (message "%s, %s" title href)
            (gnus-group-make-group title '(nnrss ""))
            (push (list title href title) nnrss-group-alist))))
      (nnrss-save-server-data nil))

    (:with-hook gnus-group-prepare-hook
      (:hook dust/gnus-rss))))</code>
</pre>

</div>
<p>
#+end_src
</p>
</div>
</div>
<div id="outline-container-日志" class="outline-3">
<h3 id="日志"><a href="#日志">日志</a></h3>
<div class="outline-text-3" id="text-org6ff752c">
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package org-journal)
  (:doc "A simple personal diary / journal using in Emacs.")
  (:when-loaded
    (defun org-journal-file-header-func (time)
      "Custom function to create journal header."
      (concat "#+title: Daily Journal\n"
              "#+startup: overview\n\n"))
    (defun org-journal-find-location ()
      ;; Open today's journal, but specify a non-nil prefix argument in order to
      ;; inhibit inserting the heading; org-capture will insert the heading.
      (org-journal-new-entry t)
      (goto-char (point-max)))

    ;; "https://github.com/bastibe/org-journal/issues/369"
    ;; (defconst org-journal--cache-file
    ;; (no-littering-expand-var-file-name "org-journal.cache"))
    (:option org-journal-dir "~/Journal"
             org-journal-find-file 'find-file

             org-journal-date-format "%Y-%m-%d, %a"
             org-journal-carryover-items
             "TODO=\"TODO\"|TODO=\"DOING\"|TODO=\"WAIT\""

             org-journal-file-type 'daily
             org-journal-file-header 'org-journal-file-header-func

             org-journal-enable-cache t

             org-journal-file-format "%Y%m%d.org"
             org-journal-hide-entries-p nil

             org-journal-enable-agenda-integration t))
  (defun dust/org-journal-new-journal ()
    (interactive)
    (org-journal-new-entry t))
  (:global "C-c C-j" dust/org-journal-new-journal)
  )</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-笔记管理" class="outline-3">
<h3 id="笔记管理"><a href="#笔记管理">笔记管理</a></h3>
<div class="outline-text-3" id="text-orgde784d8">
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package denote)
  (:doc "A simple note-taking tool for Emacs")
  (defun denote-subdirectory-with-template ()
    "Create note while prompting for a subdirectory.

Available candidates include the value of the variable
`denote-directory' and any subdirectory thereof.

This is equivalent to calling `denote' when `denote-prompts' is
set to '(subdirectory title keywords)."
    (declare (interactive-only t))
    (interactive)
    (let ((denote-prompts '(template subdirectory title keywords)))
      (call-interactively #'denote)))
  (:option
   denote-directory "~/Note"

   denote-date-format "&lt;%Y-%m-%d %a&gt;"

   denote-infer-keywords t
   denote-sort-keywords t
   denote-file-type 'org

   denote-prompts '(subdirectory title keywords)
   denote-excluded-directories-regexp "^assets\\|^static"

   ;; Pick dates, where relevant, with Org's advanced interface:
   denote-date-prompt-use-org-read-date t
   denote-allow-multi-word-keywords nil

   xref-search-program 'ripgrep

   denote-templates
   `((book . ,(concat "#+book_author: \n"
                      "#+book_translator: \n"
                      "#+book_publisher: \n"
                      "#+book_publish_date: \n\n"
                      "#+startup: overview\n\n"
                      "* Outline\n"
                      ":PROPERTIES:\n"
                      ":VISIBILITY: all\n"
                      ":END:\n\n"
                      "* Conclusion\n"
                      ":PROPERTIES:\n"
                      ":VISIBILITY: all\n"
                      ":END:\n\n"
                      "* Excerpts\n"
                      ":PROPERTIES:\n"
                      ":VISIBILITY: children\n"
                      ":END:\n"))
     (blog . ,(concat "#+publish: nil\n\n"))))
  (:when-loaded
    (:face denote-faces-date
      :foreground (face-attribute 'font-lock-function-name-face :foreground))
    (:face denote-faces-delimiter
      :foreground (face-attribute 'font-lock-comment-face :foreground))
    (:face denote-faces-extension
      :foreground (face-attribute 'font-lock-comment-face :foreground))
    (:face denote-faces-keywords
      :foreground (face-attribute 'font-lock-keyword-face :foreground))
    (:face denote-faces-title
      :foreground (face-attribute 'font-lock-string-face :foreground)))
  (:with-mode denote-dired-mode
    (:hook-into dired-mode)))</code>
</pre>

</div>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package consult-notes)
  (:doc "Easily select notes via consult.")
  (:with-hook minibuffer-setup-hook
    (:hook consult-notes-denote-mode)))</code>
</pre>

</div>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup time-stamp
  (:doc "Maintain last change time stamps in files edited by Emacs")
  (:after org
    (defun time-stamp-denote ()
      (when (and (buffer-file-name)
                 (denote-filename-is-note-p (buffer-file-name)))
        (let* ((time-stamp-start "#\\+date:[ ]*&lt;")
               (time-stamp-end "&gt;")
               (time-stamp-format denote-date-format))
          (time-stamp))))
    (:local-hook before-save-hook time-stamp-denote))
  )</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-书籍管理" class="outline-3">
<h3 id="书籍管理"><a href="#书籍管理">书籍管理</a></h3>
<div class="outline-text-3" id="text-orga56e276">
<p>
用 org mode 的 Attachment 来做书籍管理。
</p>

<div class="org-src-container">
<pre>
<code class="language-elisp">(setup org-book
  (:doc "book management")
  (:option dust/org-book-file "~/Books/books.org")
  (:after org-attach
    (:option (prepend org-attach-id-to-path-function-list)
             (lambda (id) id))
    (defun org-attach-file-list (dir)
      (--filter
       (and (not (string-prefix-p "." it))
            (not (string-suffix-p "~" it)))
       (directory-files dir nil))))
  (defun org-book ()
    (interactive)
    (find-file dust/org-book-file)))</code>
</pre>

</div>
</div>
</div>
<div id="outline-container-文档阅读" class="outline-3">
<h3 id="文档阅读"><a href="#文档阅读">文档阅读</a></h3>
<div class="outline-text-3" id="text-org62bea55">
</div>
<div id="outline-container-PDF" class="outline-4">
<h4 id="PDF"><a href="#PDF">PDF</a></h4>
<div class="outline-text-4" id="text-org45ccd37">
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package pdf-tools pdf-view-restore)
  (:doc "A replacement of DocView for PDF files.")

  (:with-hook window-setup-hook
    (:hook pdf-loader-install))



  (:when-loaded
    (:with-map pdf-view-mode-map
      (:bind "j" pdf-view-next-line-or-next-page
             "k" pdf-view-previous-line-or-previous-page
             "&lt;delete&gt;" pdf-view-scroll-down-or-previous-page))

    (:option (remove pdf-tools-enabled-modes)
             '(pdf-sync-minor-mode
               pdf-virtual-global-minor-mode))
    (:with-hook pdf-view-mode-hook
      (:hook (lambda ()
               (pdf-view-restore-mode)
               (display-line-numbers-mode 0)
               (auto-revert-mode 0))))))</code>
</pre>

</div>
</div>
</div>
<div id="outline-container-EPUB" class="outline-4">
<h4 id="EPUB"><a href="#EPUB">EPUB</a></h4>
<div class="outline-text-4" id="text-org0bcba99">
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package nov)
  (:doc "Major mode for reading EPUBs in Emacs.")
  (:file-match "\\.epub\\'"))</code>
</pre>

</div>
</div>
</div>
<div id="outline-container-DJUV" class="outline-4">
<h4 id="DJUV"><a href="#DJUV">DJUV</a></h4>
<div class="outline-text-4" id="text-orgbbb6480">
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package djvu)
  (:doc "Edit and view Djvu files via djvused")

  )</code>
</pre>

</div>
</div>
</div>
</div>
<div id="outline-container-Typst" class="outline-3">
<h3 id="Typst"><a href="#Typst">Typst</a></h3>
<div class="outline-text-3" id="text-org65b7a46">
<p>
一个新的标记语言的排版系统，用 rust 编写，它的目标是拥有 Latex 一般的能力，但是更快更简便. 虽然确实看到 ox-typst, 即把 Org Mode 导出为 Typst, 但是一种标记语言先转为另一种标记语言，何必。虽然说 Org Mode 转 pdf 也是选转成 Latex, 但是显然 Org Mode 的语言更简单，所以才有这样的需求。
</p>
</div>

<div id="outline-container-安装 Treesit For Typst" class="outline-4">
<h4 id="安装 Treesit For Typst"><a href="#安装 Treesit For Typst">安装 Treesit For Typst</a></h4>
<div class="outline-text-4" id="text-org39347b0">
<p>
<code>M-x treesit-install-language-grammar RET typst RET https://github.com/uben0/tree-sitter-typst</code>
</p>
</div>
</div>

<div id="outline-container-配置" class="outline-4">
<h4 id="配置"><a href="#配置">配置</a></h4>
<div class="outline-text-4" id="text-org5a4f78a">
<div class="org-src-container">
<pre>
<code class="language-elisp">(setup (:package (typst-ts-mode "https://git.sr.ht/~meow_king/typst-ts-mode"))
(:doc "Tree Sitter support for Typst.")
(:option typst-ts-mode-watch-options "--root ~/Kuafu"
         typst-ts-mode-compile-options "--root ~/Kuafu"
         typst-ts-mode-indent-offset 2))

;; (setup (:package (typst-mode "https://github.com/Ziqi-Yang/typst-mode.el"))
;;   (:doc "Typst mode")
;;   (:require typst-mode)
;;   (:file-match "\\.typ\\'")
;;   (:option typst-indent-offset 2)
;;   )</code>
</pre>

</div>
</div>
</div>

<div id="outline-container-trouble" class="outline-4">
<h4 id="trouble"><a href="#trouble">trouble</a></h4>
<div class="outline-text-4" id="text-org35eac89">
<ul class="org-ul">
<li><code>tree-sister 0.22.2</code>  之后都会导致崩溃。</li>
</ul>
</div>
</div>
</div>
</div>

<div id="outline-container-配置结束" class="outline-2">
<h2 id="配置结束"><a href="#配置结束">配置结束</a></h2>
<div class="outline-text-2" id="text-orgd053656">
<div class="org-src-container">
<pre>
<code class="language-elisp">(defun startup-echo-area-message ()
  (emacs-init-time "Emacs' started in %.2f sec. Enjoy hacking :)"))

(with-eval-after-load 'init
  (setq gc-cons-threshold (* 16 1024 1024)))

(provide 'init)</code>
</pre>

</div>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div id="fn.1" class="footdef"><span class="footnum"> (1) </span><a class="foot2ref" href="#fnr.1.1" role="doc-backlink"> ⇑ </a><a class="foot2ref" href="#fnr.1.2" role="doc-backlink"> ⇑ </a>
 <div class="footpara" role="doc-footnote"><p class="footpara">
<a target="_blank" href="https://emacs.nasy.moe">Nasy Emacs 配置</a>
</p></div></div>

<div id="fn.2" class="footdef"><span class="footnum"> (2) </span><a class="foot2ref" href="#fnr.2.1" role="doc-backlink"> ⇑ </a>
 <div class="footpara" role="doc-footnote"><p class="footpara">
<a target="_blank" href="https://github.com/alexluigit/emacs-grandview">GitHub - alexluigit/emacs-grandview: 原非大观。</a>
</p></div></div>

<div id="fn.3" class="footdef"><span class="footnum"> (3) </span><a class="foot2ref" href="#fnr.3.1" role="doc-backlink"> ⇑ </a>
 <div class="footpara" role="doc-footnote"><p class="footpara">
<a target="_blank" href="https://emacs-china.org/t/lsp-bridge/20786/1208?u=fingerknight">lsp-bridge &#x2013; 速度最快的语法补全插件 - #1208，来自 blove - Emacs-general - Emacs China</a>
</p></div></div>

<div id="fn.4" class="footdef"><span class="footnum"> (4) </span><a class="foot2ref" href="#fnr.4.1" role="doc-backlink"> ⇑ </a><a class="foot2ref" href="#fnr.4.2" role="doc-backlink"> ⇑ </a>
 <div class="footpara" role="doc-footnote"><p class="footpara">
<a target="_blank" href="https://www.emacswiki.org/emacs/SetupEl">EmacsWiki: Setup El</a>
</p></div></div>


</div>
</div></div>
</div>
<div id="postamble" class="status">
<center>
Powered by <a href="https://orgmode.org">Org Mode</a>.
</center>
</div>
<script src="/static/script.js"></script>
<script src="/static/prism/script.js"></script>
</body>
</html>
